<!doctype html>
<html lang="en">
    <head>
        <meta charset="utf-8" />
        <title>MEI Editor Demo Page</title>

        <link rel="stylesheet" href="//ajax.googleapis.com/ajax/libs/jqueryui/1.10.4/themes/smoothness/jquery-ui.css" />
        <link rel="stylesheet" href="//netdna.bootstrapcdn.com/bootstrap/3.1.1/css/bootstrap.min.css">
        <link rel="stylesheet" href="diva.js/build/css/diva.min.css" />
        <link rel="stylesheet" href="meix.js/css/meiEditor.css" />
        <link rel="stylesheet" href="divaEditor.css" />
        <link rel="stylesheet" href="divaManager.css" />

        <!--foreign libraries -->
        <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js" ></script>
        <script src="//ajax.googleapis.com/ajax/libs/jqueryui/1.10.4/jquery-ui.min.js"></script>
        <script src="//netdna.bootstrapcdn.com/bootstrap/3.1.1/js/bootstrap.min.js"></script>
        <script src="meix.js/js/FileSaver.js"></script> <!-- Thanks to http://eligrey.com/demos/FileSaver.js/FileSaver.js -->
        <script src="https://x2js.googlecode.com/hg/xml2json.js"></script>

        <!--local libraries -->
        <script src="diva.js/build/js/diva.js" type="text/javascript"></script>
        <script src="diva.js/build/js/utils.js" type="text/javascript"></script>
        <script src="diva.js/build/js/plugins/highlight.js" type="text/javascript"></script>
        <script src="meix.js/ace/src/ace.js" type="text/javascript" charset="utf-8"></script>

        <!--project-specific code -->
        <script src="meix.js/js/meiEditor.js"></script>
        <script src="meix.js/js/meilint.js"></script>
        <script src="meix.js/js/plugins/meiEditorFileUpload.js"></script>
        <script src="meix.js/js/plugins/meiEditorXMLValidator.js"></script>

        <script src="meiEditorDivaManager.js"></script>
        <script src="meix.js/js/UndoStack.js"></script>
        <script>
        $(function() 
        {
            jsonFile = 'imagesOut.json';
            //create the diva wrapper and editor

            $('#diva-wrapper').diva(
            {
                adaptivePadding: 0,
                contained: true,
                enableAutoTitle: false,
                enableAutoHeight: false,
                enableAutoWidth: false,
                enableFullscreen: false,
                fixedHeightGrid: false,
                iipServerURL: "http://132.206.14.136:8000/fcgi-bin/iipsrv.fcgi",
                objectData: jsonFile,
                imageDir: "/opt/stgall",
                enableHighlight: true,
                toolbarParentSelector: "#diva-toolbar",
                viewerWidthPadding: 0,
                viewerHeightPadding: 0,
            });


            divaInstance = $('#diva-wrapper').data('diva');
            meiEditor = $("#mei-editor").AceMeiEditor({
                'validatorLink': 'meix.js/validation/', 
                'xmllintLoc': 'meix.js/js/xmllint.js',
                'divaInstance': divaInstance, 
                'jsonFileLocation': jsonFile
            });

        });

        window.onload = function()
        {
            $("#diva-toolbar").prepend($("#1-diva-tools").html());
            $("#1-diva-tools").remove();
            //here so I can wait for the diva objects to actually exist
            $(window).on('resize', function(e){
                $("#diva-wrapper").offset({'top': $("#openPages").offset().top, 'left': $("#mei-editor").width()});
                $("#diva-wrapper").height(window.innerHeight);
                $("#diva-wrapper").width("50%");
                $("#1-diva-outer").height(window.innerHeight);
                $("#diva-toolbar").height($("#openPages").offset().top);
                $("#1-diva-tools-left").css('vertical-align', 'middle');
            });

            $(window).trigger('resize');
        }

        </script>
    </head>
    <body>
        <div id="mei-editor"></div>
        <div id="diva-toolbar" class="diva-tools">
            <div style="clear:both"></div>
        </div>
        <div id="diva-wrapper"></div>
    </body>
</html> 