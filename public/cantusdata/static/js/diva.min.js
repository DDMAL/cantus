Storage.prototype.setObject=function(b,e){this.setItem(b,JSON.stringify(e))};Storage.prototype.getObject=function(b){return(b=this.getItem(b))&&JSON.parse(b)};(function(b){var e=1;b.generateId=function(b){var d;do d=e++ +(b?"-"+b:"");while(document.getElementById(d));return d}})(jQuery);
(function(b){b.getScrollbarWidth=function(){var b=document.createElement("p");b.style.width="100%";b.style.height="200px";var c=document.createElement("div");c.style.position="absolute";c.style.top="0px";c.style.left="0px";c.style.visibility="hidden";c.style.width="200px";c.style.height="150px";c.style.overflow="hidden";c.appendChild(b);document.body.appendChild(c);var d=b.offsetWidth;c.style.overflow="scroll";b=b.offsetWidth;d==b&&(b=c.clientWidth);document.body.removeChild(c);return d-b}})(jQuery);
(function(b){b.getHashParam=function(b){var c=window.location.hash;if(""!==c){var d=0<c.indexOf("&"+b+"=")?c.indexOf("&"+b+"="):c.indexOf("#"+b+"=");if(0<=d)return d+=b.length+2,b=c.indexOf("&",d),b>d?c.substring(d,b):0>b?c.substring(d):""}return!1}})(jQuery);
(function(b){b.updateHashParam=function(e,c){var d=b.getHashParam(e),a=window.location.hash;if(d!==c)if("string"==typeof d){var g=0<a.indexOf("&"+e+"=")?a.indexOf("&"+e+"="):a.indexOf("#"+e+"="),d=g+e.length+2+d.length,k=0===g?"#":"&";window.location.replace(a.substring(0,g)+k+e+"="+c+a.substring(d))}else 0===a.length?window.location.replace("#"+e+"="+c):window.location.replace(a+"&"+e+"="+c)}})(jQuery);
jQuery.fn.oneFingerScroll=function(){var b,e;$(this).bind("touchstart",function(c){c=c.originalEvent;b=$(this).scrollTop()+c.touches[0].pageY;e=$(this).scrollLeft()+c.touches[0].pageX;c.preventDefault()});$(this).bind("touchmove",function(c){c=c.originalEvent;$(this).scrollTop(b-c.touches[0].pageY);$(this).scrollLeft(e-c.touches[0].pageX);c.preventDefault()});return this};
(function(b){b.fn.dragscrollable=function(e){var c=b.extend({dragSelector:">:first",acceptPropagatedEvent:!0,preventDefault:!0},e||{}),d={mouseDownHandler:function(a){if(1!=a.which||!a.data.acceptPropagatedEvent&&a.target!=this)return!1;a.data.lastCoord={left:a.clientX,top:a.clientY};b.event.add(document,"mouseup",d.mouseUpHandler,a.data);b.event.add(document,"mousemove",d.mouseMoveHandler,a.data);if(a.data.preventDefault)return a.preventDefault(),!1},mouseMoveHandler:function(a){var b=a.clientX-
a.data.lastCoord.left,c=a.clientY-a.data.lastCoord.top;a.data.scrollable.scrollLeft(a.data.scrollable.scrollLeft()-b);a.data.scrollable.scrollTop(a.data.scrollable.scrollTop()-c);a.data.lastCoord={left:a.clientX,top:a.clientY};if(a.data.preventDefault)return a.preventDefault(),!1},mouseUpHandler:function(a){b.event.remove(document,"mousemove",d.mouseMoveHandler);b.event.remove(document,"mouseup",d.mouseUpHandler);if(a.data.preventDefault)return a.preventDefault(),!1}};this.each(function(){var a={scrollable:b(this),
acceptPropagatedEvent:c.acceptPropagatedEvent,preventDefault:c.preventDefault};b(this).find(c.dragSelector).bind("mousedown",a,d.mouseDownHandler)})}})(jQuery);
(function(b,e){function c(a,c){var e,g,f,n=a.nodeName.toLowerCase();return"area"===n?(e=a.parentNode,g=e.name,a.href&&g&&"map"===e.nodeName.toLowerCase()?(f=b("img[usemap=#"+g+"]")[0],!!f&&d(f)):!1):(/input|select|textarea|button|object/.test(n)?!a.disabled:"a"===n?a.href||c:c)&&d(a)}function d(a){return b.expr.filters.visible(a)&&!b(a).parents().addBack().filter(function(){return"hidden"===b.css(this,"visibility")}).length}var a=0,g=/^ui-id-\d+$/;b.ui=b.ui||{};b.extend(b.ui,{version:"1.10.3",keyCode:{BACKSPACE:8,
COMMA:188,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,LEFT:37,NUMPAD_ADD:107,NUMPAD_DECIMAL:110,NUMPAD_DIVIDE:111,NUMPAD_ENTER:108,NUMPAD_MULTIPLY:106,NUMPAD_SUBTRACT:109,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SPACE:32,TAB:9,UP:38}});b.fn.extend({focus:function(a){return function(c,d){return"number"==typeof c?this.each(function(){var a=this;setTimeout(function(){b(a).focus();d&&d.call(a)},c)}):a.apply(this,arguments)}}(b.fn.focus),scrollParent:function(){var a;return a=b.ui.ie&&/(static|relative)/.test(this.css("position"))||
/absolute/.test(this.css("position"))?this.parents().filter(function(){return/(relative|absolute|fixed)/.test(b.css(this,"position"))&&/(auto|scroll)/.test(b.css(this,"overflow")+b.css(this,"overflow-y")+b.css(this,"overflow-x"))}).eq(0):this.parents().filter(function(){return/(auto|scroll)/.test(b.css(this,"overflow")+b.css(this,"overflow-y")+b.css(this,"overflow-x"))}).eq(0),/fixed/.test(this.css("position"))||!a.length?b(document):a},zIndex:function(a){if(a!==e)return this.css("zIndex",a);if(this.length){var c,
d;for(a=b(this[0]);a.length&&a[0]!==document;){if(c=a.css("position"),("absolute"===c||"relative"===c||"fixed"===c)&&(d=parseInt(a.css("zIndex"),10),!isNaN(d)&&0!==d))return d;a=a.parent()}}return 0},uniqueId:function(){return this.each(function(){this.id||(this.id="ui-id-"+ ++a)})},removeUniqueId:function(){return this.each(function(){g.test(this.id)&&b(this).removeAttr("id")})}});b.extend(b.expr[":"],{data:b.expr.createPseudo?b.expr.createPseudo(function(a){return function(c){return!!b.data(c,a)}}):
function(a,c,d){return!!b.data(a,d[3])},focusable:function(a){return c(a,!isNaN(b.attr(a,"tabindex")))},tabbable:function(a){var d=b.attr(a,"tabindex"),e=isNaN(d);return(e||0<=d)&&c(a,!e)}});b("<a>").outerWidth(1).jquery||b.each(["Width","Height"],function(a,c){function d(a,c,e,k){return b.each(g,function(){c-=parseFloat(b.css(a,"padding"+this))||0;e&&(c-=parseFloat(b.css(a,"border"+this+"Width"))||0);k&&(c-=parseFloat(b.css(a,"margin"+this))||0)}),c}var g="Width"===c?["Left","Right"]:["Top","Bottom"],
f=c.toLowerCase(),n={innerWidth:b.fn.innerWidth,innerHeight:b.fn.innerHeight,outerWidth:b.fn.outerWidth,outerHeight:b.fn.outerHeight};b.fn["inner"+c]=function(a){return a===e?n["inner"+c].call(this):this.each(function(){b(this).css(f,d(this,a)+"px")})};b.fn["outer"+c]=function(a,e){return"number"!=typeof a?n["outer"+c].call(this,a):this.each(function(){b(this).css(f,d(this,a,!0,e)+"px")})}});b.fn.addBack||(b.fn.addBack=function(a){return this.add(null==a?this.prevObject:this.prevObject.filter(a))});
b("<a>").data("a-b","a").removeData("a-b").data("a-b")&&(b.fn.removeData=function(a){return function(c){return arguments.length?a.call(this,b.camelCase(c)):a.call(this)}}(b.fn.removeData));b.ui.ie=!!/msie [\w.]+/.exec(navigator.userAgent.toLowerCase());b.support.selectstart="onselectstart"in document.createElement("div");b.fn.extend({disableSelection:function(){return this.bind((b.support.selectstart?"selectstart":"mousedown")+".ui-disableSelection",function(a){a.preventDefault()})},enableSelection:function(){return this.unbind(".ui-disableSelection")}});
b.extend(b.ui,{plugin:{add:function(a,c,d){var e;a=b.ui[a].prototype;for(e in d)a.plugins[e]=a.plugins[e]||[],a.plugins[e].push([c,d[e]])},call:function(a,b,c){var d=a.plugins[b];if(d&&a.element[0].parentNode&&11!==a.element[0].parentNode.nodeType)for(b=0;d.length>b;b++)a.options[d[b][0]]&&d[b][1].apply(a.element,c)}},hasScroll:function(a,c){if("hidden"===b(a).css("overflow"))return!1;var d=c&&"left"===c?"scrollLeft":"scrollTop",e=!1;return 0<a[d]?!0:(a[d]=1,e=0<a[d],a[d]=0,e)}})})(jQuery);
(function(b,e){var c=0,d=Array.prototype.slice,a=b.cleanData;b.cleanData=function(c){for(var d,e=0;null!=(d=c[e]);e++)try{b(d).triggerHandler("remove")}catch(h){}a(c)};b.widget=function(a,c,d){var h,l,f,n,q={},s=a.split(".")[0];a=a.split(".")[1];h=s+"-"+a;d||(d=c,c=b.Widget);b.expr[":"][h.toLowerCase()]=function(a){return!!b.data(a,h)};b[s]=b[s]||{};l=b[s][a];f=b[s][a]=function(a,b){return this._createWidget?(arguments.length&&this._createWidget(a,b),e):new f(a,b)};b.extend(f,l,{version:d.version,
_proto:b.extend({},d),_childConstructors:[]});n=new c;n.options=b.widget.extend({},n.options);b.each(d,function(a,d){return b.isFunction(d)?(q[a]=function(){var b=function(){return c.prototype[a].apply(this,arguments)},e=function(b){return c.prototype[a].apply(this,b)};return function(){var a,c=this._super,g=this._superApply;return this._super=b,this._superApply=e,a=d.apply(this,arguments),this._super=c,this._superApply=g,a}}(),e):(q[a]=d,e)});f.prototype=b.widget.extend(n,{widgetEventPrefix:l?n.widgetEventPrefix:
a},q,{constructor:f,namespace:s,widgetName:a,widgetFullName:h});l?(b.each(l._childConstructors,function(a,c){var d=c.prototype;b.widget(d.namespace+"."+d.widgetName,f,c._proto)}),delete l._childConstructors):c._childConstructors.push(f);b.widget.bridge(a,f)};b.widget.extend=function(a){for(var c,m,h=d.call(arguments,1),l=0,f=h.length;f>l;l++)for(c in h[l])m=h[l][c],h[l].hasOwnProperty(c)&&m!==e&&(a[c]=b.isPlainObject(m)?b.isPlainObject(a[c])?b.widget.extend({},a[c],m):b.widget.extend({},m):m);return a};
b.widget.bridge=function(a,c){var m=c.prototype.widgetFullName||a;b.fn[a]=function(h){var l="string"==typeof h,f=d.call(arguments,1),n=this;return h=!l&&f.length?b.widget.extend.apply(null,[h].concat(f)):h,l?this.each(function(){var c,d=b.data(this,m);return d?b.isFunction(d[h])&&"_"!==h.charAt(0)?(c=d[h].apply(d,f),c!==d&&c!==e?(n=c&&c.jquery?n.pushStack(c.get()):c,!1):e):b.error("no such method '"+h+"' for "+a+" widget instance"):b.error("cannot call methods on "+a+" prior to initialization; attempted to call method '"+
h+"'")}):this.each(function(){var a=b.data(this,m);a?a.option(h||{})._init():b.data(this,m,new c(h,this))}),n}};b.Widget=function(){};b.Widget._childConstructors=[];b.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{disabled:!1,create:null},_createWidget:function(a,d){d=b(d||this.defaultElement||this)[0];this.element=b(d);this.uuid=c++;this.eventNamespace="."+this.widgetName+this.uuid;this.options=b.widget.extend({},this.options,this._getCreateOptions(),a);
this.bindings=b();this.hoverable=b();this.focusable=b();d!==this&&(b.data(d,this.widgetFullName,this),this._on(!0,this.element,{remove:function(a){a.target===d&&this.destroy()}}),this.document=b(d.style?d.ownerDocument:d.document||d),this.window=b(this.document[0].defaultView||this.document[0].parentWindow));this._create();this._trigger("create",null,this._getCreateEventData());this._init()},_getCreateOptions:b.noop,_getCreateEventData:b.noop,_create:b.noop,_init:b.noop,destroy:function(){this._destroy();
this.element.unbind(this.eventNamespace).removeData(this.widgetName).removeData(this.widgetFullName).removeData(b.camelCase(this.widgetFullName));this.widget().unbind(this.eventNamespace).removeAttr("aria-disabled").removeClass(this.widgetFullName+"-disabled ui-state-disabled");this.bindings.unbind(this.eventNamespace);this.hoverable.removeClass("ui-state-hover");this.focusable.removeClass("ui-state-focus")},_destroy:b.noop,widget:function(){return this.element},option:function(a,c){var d,h,l,f=a;
if(0===arguments.length)return b.widget.extend({},this.options);if("string"==typeof a)if(f={},d=a.split("."),a=d.shift(),d.length){h=f[a]=b.widget.extend({},this.options[a]);for(l=0;d.length-1>l;l++)h[d[l]]=h[d[l]]||{},h=h[d[l]];if(a=d.pop(),c===e)return h[a]===e?null:h[a];h[a]=c}else{if(c===e)return this.options[a]===e?null:this.options[a];f[a]=c}return this._setOptions(f),this},_setOptions:function(a){for(var b in a)this._setOption(b,a[b]);return this},_setOption:function(a,b){return this.options[a]=
b,"disabled"===a&&(this.widget().toggleClass(this.widgetFullName+"-disabled ui-state-disabled",!!b).attr("aria-disabled",b),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")),this},enable:function(){return this._setOption("disabled",!1)},disable:function(){return this._setOption("disabled",!0)},_on:function(a,c,d){var h,l=this;"boolean"!=typeof a&&(d=c,c=a,a=!1);d?(c=h=b(c),this.bindings=this.bindings.add(c)):(d=c,c=this.element,h=this.widget());b.each(d,function(d,
n){function q(){return a||!0!==l.options.disabled&&!b(this).hasClass("ui-state-disabled")?("string"==typeof n?l[n]:n).apply(l,arguments):e}"string"!=typeof n&&(q.guid=n.guid=n.guid||q.guid||b.guid++);var m=d.match(/^(\w+)\s*(.*)$/),r=m[1]+l.eventNamespace;(m=m[2])?h.delegate(m,r,q):c.bind(r,q)})},_off:function(a,b){b=(b||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace;a.unbind(b).undelegate(b)},_delay:function(a,b){var c=this;return setTimeout(function(){return("string"==typeof a?
c[a]:a).apply(c,arguments)},b||0)},_hoverable:function(a){this.hoverable=this.hoverable.add(a);this._on(a,{mouseenter:function(a){b(a.currentTarget).addClass("ui-state-hover")},mouseleave:function(a){b(a.currentTarget).removeClass("ui-state-hover")}})},_focusable:function(a){this.focusable=this.focusable.add(a);this._on(a,{focusin:function(a){b(a.currentTarget).addClass("ui-state-focus")},focusout:function(a){b(a.currentTarget).removeClass("ui-state-focus")}})},_trigger:function(a,c,d){var e,l=this.options[a];
if(d=d||{},c=b.Event(c),c.type=(a===this.widgetEventPrefix?a:this.widgetEventPrefix+a).toLowerCase(),c.target=this.element[0],a=c.originalEvent)for(e in a)e in c||(c[e]=a[e]);return this.element.trigger(c,d),!(b.isFunction(l)&&!1===l.apply(this.element[0],[c].concat(d))||c.isDefaultPrevented())}};b.each({show:"fadeIn",hide:"fadeOut"},function(a,c){b.Widget.prototype["_"+a]=function(d,e,l){"string"==typeof e&&(e={effect:e});var f,n=e?!0===e||"number"==typeof e?c:e.effect||c:a;e=e||{};"number"==typeof e&&
(e={duration:e});f=!b.isEmptyObject(e);e.complete=l;e.delay&&d.delay(e.delay);f&&b.effects&&b.effects.effect[n]?d[a](e):n!==a&&d[n]?d[n](e.duration,e.easing,l):d.queue(function(c){b(this)[a]();l&&l.call(d[0]);c()})}})})(jQuery);
(function(b){var e=!1;b(document).mouseup(function(){e=!1});b.widget("ui.mouse",{version:"1.10.3",options:{cancel:"input,textarea,button,select,option",distance:1,delay:0},_mouseInit:function(){var c=this;this.element.bind("mousedown."+this.widgetName,function(b){return c._mouseDown(b)}).bind("click."+this.widgetName,function(d){return!0===b.data(d.target,c.widgetName+".preventClickEvent")?(b.removeData(d.target,c.widgetName+".preventClickEvent"),d.stopImmediatePropagation(),!1):void 0});this.started=
!1},_mouseDestroy:function(){this.element.unbind("."+this.widgetName);this._mouseMoveDelegate&&b(document).unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate)},_mouseDown:function(c){if(!e){this._mouseStarted&&this._mouseUp(c);this._mouseDownEvent=c;var d=this,a=1===c.which,g="string"==typeof this.options.cancel&&c.target.nodeName?b(c.target).closest(this.options.cancel).length:!1;return a&&!g&&this._mouseCapture(c)?(this.mouseDelayMet=
!this.options.delay,this.mouseDelayMet||(this._mouseDelayTimer=setTimeout(function(){d.mouseDelayMet=!0},this.options.delay)),this._mouseDistanceMet(c)&&this._mouseDelayMet(c)&&(this._mouseStarted=!1!==this._mouseStart(c),!this._mouseStarted)?(c.preventDefault(),!0):(!0===b.data(c.target,this.widgetName+".preventClickEvent")&&b.removeData(c.target,this.widgetName+".preventClickEvent"),this._mouseMoveDelegate=function(a){return d._mouseMove(a)},this._mouseUpDelegate=function(a){return d._mouseUp(a)},
b(document).bind("mousemove."+this.widgetName,this._mouseMoveDelegate).bind("mouseup."+this.widgetName,this._mouseUpDelegate),c.preventDefault(),e=!0,!0)):!0}},_mouseMove:function(c){return b.ui.ie&&(!document.documentMode||9>document.documentMode)&&!c.button?this._mouseUp(c):this._mouseStarted?(this._mouseDrag(c),c.preventDefault()):(this._mouseDistanceMet(c)&&this._mouseDelayMet(c)&&(this._mouseStarted=!1!==this._mouseStart(this._mouseDownEvent,c),this._mouseStarted?this._mouseDrag(c):this._mouseUp(c)),
!this._mouseStarted)},_mouseUp:function(c){return b(document).unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate),this._mouseStarted&&(this._mouseStarted=!1,c.target===this._mouseDownEvent.target&&b.data(c.target,this.widgetName+".preventClickEvent",!0),this._mouseStop(c)),!1},_mouseDistanceMet:function(b){return Math.max(Math.abs(this._mouseDownEvent.pageX-b.pageX),Math.abs(this._mouseDownEvent.pageY-b.pageY))>=this.options.distance},
_mouseDelayMet:function(){return this.mouseDelayMet},_mouseStart:function(){},_mouseDrag:function(){},_mouseStop:function(){},_mouseCapture:function(){return!0}})})(jQuery);
(function(b){b.widget("ui.slider",b.ui.mouse,{version:"1.10.3",widgetEventPrefix:"slide",options:{animate:!1,distance:0,max:100,min:0,orientation:"horizontal",range:!1,step:1,value:0,values:null,change:null,slide:null,start:null,stop:null},_create:function(){this._mouseSliding=this._keySliding=!1;this._animateOff=!0;this._handleIndex=null;this._detectOrientation();this._mouseInit();this.element.addClass("ui-slider ui-slider-"+this.orientation+" ui-widget ui-widget-content ui-corner-all");this._refresh();
this._setOption("disabled",this.options.disabled);this._animateOff=!1},_refresh:function(){this._createRange();this._createHandles();this._setupEvents();this._refreshValue()},_createHandles:function(){var e,c;e=this.options;var d=this.element.find(".ui-slider-handle").addClass("ui-state-default ui-corner-all"),a=[];c=e.values&&e.values.length||1;d.length>c&&(d.slice(c).remove(),d=d.slice(0,c));for(e=d.length;c>e;e++)a.push("<a class='ui-slider-handle ui-state-default ui-corner-all' href='#'></a>");
this.handles=d.add(b(a.join("")).appendTo(this.element));this.handle=this.handles.eq(0);this.handles.each(function(a){b(this).data("ui-slider-handle-index",a)})},_createRange:function(){var e=this.options,c="";e.range?(!0===e.range&&(e.values?e.values.length&&2!==e.values.length?e.values=[e.values[0],e.values[0]]:b.isArray(e.values)&&(e.values=e.values.slice(0)):e.values=[this._valueMin(),this._valueMin()]),this.range&&this.range.length?this.range.removeClass("ui-slider-range-min ui-slider-range-max").css({left:"",
bottom:""}):(this.range=b("<div></div>").appendTo(this.element),c="ui-slider-range ui-widget-header ui-corner-all"),this.range.addClass(c+("min"===e.range||"max"===e.range?" ui-slider-range-"+e.range:""))):this.range=b([])},_setupEvents:function(){var b=this.handles.add(this.range).filter("a");this._off(b);this._on(b,this._handleEvents);this._hoverable(b);this._focusable(b)},_destroy:function(){this.handles.remove();this.range.remove();this.element.removeClass("ui-slider ui-slider-horizontal ui-slider-vertical ui-widget ui-widget-content ui-corner-all");
this._mouseDestroy()},_mouseCapture:function(e){var c,d,a,g,k,m,h,l,f=this,n=this.options;return n.disabled?!1:(this.elementSize={width:this.element.outerWidth(),height:this.element.outerHeight()},this.elementOffset=this.element.offset(),c={x:e.pageX,y:e.pageY},d=this._normValueFromMouse(c),a=this._valueMax()-this._valueMin()+1,this.handles.each(function(c){var e=Math.abs(d-f.values(c));(a>e||a===e&&(c===f._lastChangedValue||f.values(c)===n.min))&&(a=e,g=b(this),k=c)}),m=this._start(e,k),!1===m?!1:
(this._mouseSliding=!0,this._handleIndex=k,g.addClass("ui-state-active").focus(),h=g.offset(),l=!b(e.target).parents().addBack().is(".ui-slider-handle"),this._clickOffset=l?{left:0,top:0}:{left:e.pageX-h.left-g.width()/2,top:e.pageY-h.top-g.height()/2-(parseInt(g.css("borderTopWidth"),10)||0)-(parseInt(g.css("borderBottomWidth"),10)||0)+(parseInt(g.css("marginTop"),10)||0)},this.handles.hasClass("ui-state-hover")||this._slide(e,k,d),this._animateOff=!0,!0))},_mouseStart:function(){return!0},_mouseDrag:function(b){var c=
this._normValueFromMouse({x:b.pageX,y:b.pageY});return this._slide(b,this._handleIndex,c),!1},_mouseStop:function(b){return this.handles.removeClass("ui-state-active"),this._mouseSliding=!1,this._stop(b,this._handleIndex),this._change(b,this._handleIndex),this._handleIndex=null,this._clickOffset=null,this._animateOff=!1,!1},_detectOrientation:function(){this.orientation="vertical"===this.options.orientation?"vertical":"horizontal"},_normValueFromMouse:function(b){var c,d,a,g,k;return"horizontal"===
this.orientation?(c=this.elementSize.width,d=b.x-this.elementOffset.left-(this._clickOffset?this._clickOffset.left:0)):(c=this.elementSize.height,d=b.y-this.elementOffset.top-(this._clickOffset?this._clickOffset.top:0)),a=d/c,1<a&&(a=1),0>a&&(a=0),"vertical"===this.orientation&&(a=1-a),g=this._valueMax()-this._valueMin(),k=this._valueMin()+a*g,this._trimAlignValue(k)},_start:function(b,c){var d={handle:this.handles[c],value:this.value()};return this.options.values&&this.options.values.length&&(d.value=
this.values(c),d.values=this.values()),this._trigger("start",b,d)},_slide:function(b,c,d){var a,g,k;this.options.values&&this.options.values.length?(a=this.values(c?0:1),2===this.options.values.length&&!0===this.options.range&&(0===c&&d>a||1===c&&a>d)&&(d=a),d!==this.values(c)&&(g=this.values(),g[c]=d,k=this._trigger("slide",b,{handle:this.handles[c],value:d,values:g}),this.values(c?0:1),!1!==k&&this.values(c,d,!0))):d!==this.value()&&(k=this._trigger("slide",b,{handle:this.handles[c],value:d}),!1!==
k&&this.value(d))},_stop:function(b,c){var d={handle:this.handles[c],value:this.value()};this.options.values&&this.options.values.length&&(d.value=this.values(c),d.values=this.values());this._trigger("stop",b,d)},_change:function(b,c){if(!this._keySliding&&!this._mouseSliding){var d={handle:this.handles[c],value:this.value()};this.options.values&&this.options.values.length&&(d.value=this.values(c),d.values=this.values());this._lastChangedValue=c;this._trigger("change",b,d)}},value:function(b){return arguments.length?
(this.options.value=this._trimAlignValue(b),this._refreshValue(),this._change(null,0),void 0):this._value()},values:function(e,c){var d,a,g;if(1<arguments.length)return this.options.values[e]=this._trimAlignValue(c),this._refreshValue(),this._change(null,e),void 0;if(!arguments.length)return this._values();if(!b.isArray(arguments[0]))return this.options.values&&this.options.values.length?this._values(e):this.value();d=this.options.values;a=arguments[0];for(g=0;d.length>g;g+=1)d[g]=this._trimAlignValue(a[g]),
this._change(null,g);this._refreshValue()},_setOption:function(e,c){var d,a=0;switch("range"===e&&!0===this.options.range&&("min"===c?(this.options.value=this._values(0),this.options.values=null):"max"===c&&(this.options.value=this._values(this.options.values.length-1),this.options.values=null)),b.isArray(this.options.values)&&(a=this.options.values.length),b.Widget.prototype._setOption.apply(this,arguments),e){case "orientation":this._detectOrientation();this.element.removeClass("ui-slider-horizontal ui-slider-vertical").addClass("ui-slider-"+
this.orientation);this._refreshValue();break;case "value":this._animateOff=!0;this._refreshValue();this._change(null,0);this._animateOff=!1;break;case "values":this._animateOff=!0;this._refreshValue();for(d=0;a>d;d+=1)this._change(null,d);this._animateOff=!1;break;case "min":case "max":this._animateOff=!0;this._refreshValue();this._animateOff=!1;break;case "range":this._animateOff=!0,this._refresh(),this._animateOff=!1}},_value:function(){return this._trimAlignValue(this.options.value)},_values:function(b){var c,
d;if(arguments.length)return c=this.options.values[b],this._trimAlignValue(c);if(this.options.values&&this.options.values.length){c=this.options.values.slice();for(d=0;c.length>d;d+=1)c[d]=this._trimAlignValue(c[d]);return c}return[]},_trimAlignValue:function(b){if(this._valueMin()>=b)return this._valueMin();if(b>=this._valueMax())return this._valueMax();var c=0<this.options.step?this.options.step:1,d=(b-this._valueMin())%c;b-=d;return 2*Math.abs(d)>=c&&(b+=0<d?c:-c),parseFloat(b.toFixed(5))},_valueMin:function(){return this.options.min},
_valueMax:function(){return this.options.max},_refreshValue:function(){var e,c,d,a,g,k=this.options.range,m=this.options,h=this,l=this._animateOff?!1:m.animate,f={};this.options.values&&this.options.values.length?this.handles.each(function(a){c=100*((h.values(a)-h._valueMin())/(h._valueMax()-h._valueMin()));f["horizontal"===h.orientation?"left":"bottom"]=c+"%";b(this).stop(1,1)[l?"animate":"css"](f,m.animate);!0===h.options.range&&("horizontal"===h.orientation?(0===a&&h.range.stop(1,1)[l?"animate":
"css"]({left:c+"%"},m.animate),1===a&&h.range[l?"animate":"css"]({width:c-e+"%"},{queue:!1,duration:m.animate})):(0===a&&h.range.stop(1,1)[l?"animate":"css"]({bottom:c+"%"},m.animate),1===a&&h.range[l?"animate":"css"]({height:c-e+"%"},{queue:!1,duration:m.animate})));e=c}):(d=this.value(),a=this._valueMin(),g=this._valueMax(),c=g!==a?(d-a)/(g-a)*100:0,f["horizontal"===this.orientation?"left":"bottom"]=c+"%",this.handle.stop(1,1)[l?"animate":"css"](f,m.animate),"min"===k&&"horizontal"===this.orientation&&
this.range.stop(1,1)[l?"animate":"css"]({width:c+"%"},m.animate),"max"===k&&"horizontal"===this.orientation&&this.range[l?"animate":"css"]({width:100-c+"%"},{queue:!1,duration:m.animate}),"min"===k&&"vertical"===this.orientation&&this.range.stop(1,1)[l?"animate":"css"]({height:c+"%"},m.animate),"max"===k&&"vertical"===this.orientation&&this.range[l?"animate":"css"]({height:100-c+"%"},{queue:!1,duration:m.animate}))},_handleEvents:{keydown:function(e){var c,d,a,g=b(e.target).data("ui-slider-handle-index");
switch(e.keyCode){case b.ui.keyCode.HOME:case b.ui.keyCode.END:case b.ui.keyCode.PAGE_UP:case b.ui.keyCode.PAGE_DOWN:case b.ui.keyCode.UP:case b.ui.keyCode.RIGHT:case b.ui.keyCode.DOWN:case b.ui.keyCode.LEFT:if(e.preventDefault(),!this._keySliding&&(this._keySliding=!0,b(e.target).addClass("ui-state-active"),c=this._start(e,g),!1===c))return}switch(a=this.options.step,c=d=this.options.values&&this.options.values.length?this.values(g):this.value(),e.keyCode){case b.ui.keyCode.HOME:d=this._valueMin();
break;case b.ui.keyCode.END:d=this._valueMax();break;case b.ui.keyCode.PAGE_UP:d=this._trimAlignValue(c+(this._valueMax()-this._valueMin())/5);break;case b.ui.keyCode.PAGE_DOWN:d=this._trimAlignValue(c-(this._valueMax()-this._valueMin())/5);break;case b.ui.keyCode.UP:case b.ui.keyCode.RIGHT:if(c===this._valueMax())return;d=this._trimAlignValue(c+a);break;case b.ui.keyCode.DOWN:case b.ui.keyCode.LEFT:if(c===this._valueMin())return;d=this._trimAlignValue(c-a)}this._slide(e,g,d)},click:function(b){b.preventDefault()},
keyup:function(e){var c=b(e.target).data("ui-slider-handle-index");this._keySliding&&(this._keySliding=!1,this._stop(e,c),this._change(e,c),b(e.target).removeClass("ui-state-active"))}}})})(jQuery);
(function(b){var e={cursor:"move",decelerate:!0,triggerHardware:!1,y:!0,x:!0,slowdown:.9,maxvelocity:40,throttleFPS:60,movingClass:{up:"kinetic-moving-up",down:"kinetic-moving-down",left:"kinetic-moving-left",right:"kinetic-moving-right"},deceleratingClass:{up:"kinetic-decelerating-up",down:"kinetic-decelerating-down",left:"kinetic-decelerating-left",right:"kinetic-decelerating-right"}};window.requestAnimationFrame||(window.requestAnimationFrame=function(){return window.webkitRequestAnimationFrame||
window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(a,b){window.setTimeout(a,1E3/60)}}());b.support=b.support||{};b.extend(b.support,{touch:"ontouchend"in document});var c=function(){return!1},d=function(a,b){return 0===Math.floor(Math.abs(a))?0:a*b},a=function(a,b){var c=a;0<a?a>b&&(c=b):a<0-b&&(c=0-b);return c},g=function(a,b){this.removeClass(a.movingClass.up).removeClass(a.movingClass.down).removeClass(a.movingClass.left).removeClass(a.movingClass.right).removeClass(a.deceleratingClass.up).removeClass(a.deceleratingClass.down).removeClass(a.deceleratingClass.left).removeClass(a.deceleratingClass.right);
0<a.velocity&&this.addClass(b.right);0>a.velocity&&this.addClass(b.left);0<a.velocityY&&this.addClass(b.down);0>a.velocityY&&this.addClass(b.up)},k=function(a,b){b.velocity=0;b.velocityY=0;b.decelerate=!0;"function"===typeof b.stopped&&b.stopped.call(a,b)},m=function(a,b){var c=a[0];b.x&&0<c.scrollWidth?(c.scrollLeft=b.scrollLeft=c.scrollLeft+b.velocity,0<Math.abs(b.velocity)&&(b.velocity=b.decelerate?d(b.velocity,b.slowdown):b.velocity)):b.velocity=0;b.y&&0<c.scrollHeight?(c.scrollTop=b.scrollTop=
c.scrollTop+b.velocityY,0<Math.abs(b.velocityY)&&(b.velocityY=b.decelerate?d(b.velocityY,b.slowdown):b.velocityY)):b.velocityY=0;g.call(a,b,b.deceleratingClass);"function"===typeof b.moved&&b.moved.call(a,b);0<Math.abs(b.velocity)||0<Math.abs(b.velocityY)?window.requestAnimationFrame(function(){m(a,b)}):k(a,b)},h=function(a,c){var d=b.kinetic.callMethods[a],e=Array.prototype.slice.call(arguments);d&&this.each(function(){var a=e.slice(1),c=b(this).data("kinetic-settings");a.unshift(c);d.apply(this,
a)})},l=function(a,d){b.support.touch?a.bind("touchstart",d.events.touchStart).bind("touchend",d.events.inputEnd).bind("touchmove",d.events.touchMove):a.mousedown(d.events.inputDown).mouseup(d.events.inputEnd).mousemove(d.events.inputMove);a.click(d.events.inputClick).scroll(d.events.scroll).bind("selectstart",c).bind("dragstart",d.events.dragStart)},f=function(c){this.addClass("kinetic-active").each(function(){var d=this,k=b(this);if(!k.data("kinetic-settings")){var f=b.extend({},e,c),h,t=!1,p,w=
!1,u=!1,F=1E3/f.throttleFPS,G,H;f.velocity=0;f.velocityY=0;var v=function(){u=p=h=!1};b(document).mouseup(v).click(v);var I=function(){f.velocity=a(t-h,f.maxvelocity);f.velocityY=a(w-p,f.maxvelocity)},y=function(a){return b.isFunction(f.filterTarget)?!1!==f.filterTarget.call(d,a):!0},x=function(a,c){if(!G||new Date>new Date(G.getTime()+F))G=new Date,u&&(h||p)&&(H&&(b(H).blur(),H=null,k.focus()),f.decelerate=!1,f.velocity=f.velocityY=0,k[0].scrollLeft=f.scrollLeft=f.x?k[0].scrollLeft-(a-h):k[0].scrollLeft,
k[0].scrollTop=f.scrollTop=f.y?k[0].scrollTop-(c-p):k[0].scrollTop,t=h,w=p,h=a,p=c,I(),g.call(k,f,f.movingClass),"function"===typeof f.moved&&f.moved.call(k,f))};f.events={touchStart:function(a){var b;if(y(a.target)){b=a.originalEvent.touches[0];var c=b.clientX;b=b.clientY;u=!0;f.velocity=t=0;f.velocityY=w=0;h=c;p=b;a.stopPropagation()}},touchMove:function(a){var b;u&&(b=a.originalEvent.touches[0],x(b.clientX,b.clientY),a.preventDefault&&a.preventDefault())},inputDown:function(a){if(y(a.target)){var b=
a.clientX,c=a.clientY;u=!0;f.velocity=t=0;f.velocityY=w=0;h=b;p=c;H=a.target;"IMG"===a.target.nodeName&&a.preventDefault();a.stopPropagation()}},inputEnd:function(a){h&&t&&!1===f.decelerate&&(f.decelerate=!0,I(),h=t=u=!1,m(k,f));H=null;a.preventDefault&&a.preventDefault()},inputMove:function(a){u&&(x(a.clientX,a.clientY),a.preventDefault&&a.preventDefault())},scroll:function(a){"function"===typeof f.moved&&f.moved.call(k,f);a.preventDefault&&a.preventDefault()},inputClick:function(a){if(0<Math.abs(f.velocity))return a.preventDefault(),
!1},dragStart:function(a){if(H)return!1}};l(k,f);k.data("kinetic-settings",f).css("cursor",f.cursor);f.triggerHardware&&k.css({"-webkit-transform":"translate3d(0,0,0)","-webkit-perspective":"1000","-webkit-backface-visibility":"hidden"})}})};b.kinetic={settingsKey:"kinetic-settings",callMethods:{start:function(a,c){var d=b(this);if(a=b.extend(a,c))a.decelerate=!1,m(d,a)},end:function(a,c){b(this);a&&(a.decelerate=!0)},stop:function(a,c){var d=b(this);k(d,a)},detach:function(a,d){var e=b(this);b.support.touch?
e.unbind("touchstart",a.events.touchStart).unbind("touchend",a.events.inputEnd).unbind("touchmove",a.events.touchMove):e.unbind("mousedown",a.events.inputDown).unbind("mouseup",a.events.inputEnd).unbind("mousemove",a.events.inputMove).unbind("scroll",a.events.scroll);e.unbind("click",a.events.inputClick).unbind("selectstart",c);e.unbind("dragstart",a.events.dragStart);e.removeClass("kinetic-active").css("cursor","")},attach:function(a,c){var d=b(this);l(d,a);d.addClass("kinetic-active").css("cursor",
"move")}}};b.fn.kinetic=function(a){"string"===typeof a?h.apply(this,arguments):f.call(this,a);return this}})(window.jQuery||window.Zepto);var diva=function(){var b={};return{Events:{publish:function(e,c,d){if(b[e]){e=b[e];for(var a=e.length;a--;)e[a].apply(d||this,c||[])}},subscribe:function(e,c){b[e]||(b[e]=[]);b[e].push(c);return[e,c]},unsubscribe:function(e,c){var d=e[0],a=b[d].length;if(b[d])for(;a--;)b[d][a]===e[1]&&(b[d].splice(b[d][a],1),c&&delete b[d])}}}}();window.divaPlugins=[];
(function(b){var e=function(c,d){var a=b.extend({},{adaptivePadding:.05,arrowScrollAmount:40,blockMobileMove:!0,objectData:"",enableAutoHeight:!1,enableAutoTitle:!0,enableAutoWidth:!0,enableCanvas:!0,enableDownload:!0,enableFilename:!0,enableFullscreen:!0,enableGotoPage:!0,enableGridIcon:!0,enableGridControls:"buttons",enableKeyScroll:!0,enableLinkIcon:!0,enableSpaceScroll:!1,enableToolbar:!0,enableZoomControls:"buttons",fixedPadding:10,fixedHeightGrid:!0,goDirectlyTo:0,iipServerURL:"",inFullscreen:!1,
inGrid:!1,imageDir:"",maxPagesPerRow:8,maxZoomLevel:-1,minPagesPerRow:2,minZoomLevel:0,onDocumentLoaded:null,onModeToggle:null,onViewToggle:null,onJump:null,onPageLoad:null,onPageLoaded:null,onReady:null,onScroll:null,onScrollDown:null,onScrollUp:null,onSetCurrentPage:null,onZoom:null,onZoomIn:null,onZoomOut:null,pageLoadTimeout:200,pagesPerRow:5,rowLoadTimeout:50,throbberTimeout:100,tileHeight:256,tileWidth:256,toolbarParentSelector:null,viewerHeightPadding:15,viewerWidthPadding:30,viewportMargin:200,
zoomLevel:2},d);b.extend(a,{allTilesLoaded:[],averageHeights:[],averageWidths:[],currentPageIndex:0,dimAfterZoom:0,divaIsFullWindow:!1,firstPageLoaded:-1,firstRowLoaded:-1,gridPageWidth:0,hashParamSuffix:"",heightAbovePages:[],heightProportion:0,horizontalOffset:0,horizontalPadding:0,ID:null,innerSelector:"",itemTitle:"",lastPageLoaded:-1,lastRowLoaded:-1,leftScrollSoFar:0,loaded:!1,maxWidths:[],maxRatio:0,minHeight:0,minRatio:0,minWidth:0,mobileWebkit:!1,numPages:0,numRows:0,oldPagesPerRow:0,oldZoomLevel:-1,
orientationChange:!1,outerSelector:"",pages:[],pageLeftOffsets:[],pageTimeouts:[],pageTools:"",panelHeight:0,panelWidth:0,plugins:[],previousTopScroll:0,preZoomOffset:null,realMaxZoom:-1,resizeTimer:-1,rowHeight:0,scaleWait:!1,selector:"",singleClick:!1,isScrollable:!0,initialKeyScroll:!1,initialSpaceScroll:!1,scrollbarWidth:0,throbberTimeoutID:-1,toolbar:null,topScrollSoFar:0,totalHeights:[],totalHeight:0,verticalOffset:0,verticalPadding:0,widthProportion:0,viewerXOffset:0,viewerYOffset:0});var e=
this,k=function(a){var b=!0;return function(a){var c,d,X;if("function"===typeof a){c=[];d=1;for(X=arguments.length;d<X;d++)c.push(arguments[d]);b&&(console.warn('The use of callback functions is deprecated. Use diva.Events.subscribe("Event", function) instead.'),b=!1);a.apply(e,c);return!0}return!1}}(),m=function(b,c){return a.pages[b].d[a.zoomLevel][c]},h=function(b){var c,d=a.numPages;for(c=0;c<d;c++)if(a.pages[c].f===b)return c;return-1},l=function(b,c){var d=a.topScrollSoFar-a.viewportMargin,
e=d+a.panelHeight+2*a.viewportMargin;return b>=d&&b<=e||b<=d&&c>=e||c>=d&&c<=e},f=function(b){return 0<=b&&b<a.numPages},n=function(b){var c=a.heightAbovePages[b];b=c+m(b,"h")+a.verticalPadding;return l(c,b)},q=function(c){if(!(0<b(document.getElementById(a.ID+"page-"+c)).length&&a.allTilesLoaded[c])){var d=a.pages[c].f,e=m(c,"w"),g=m(c,"h"),f=a.heightAbovePages[c]+a.verticalPadding,h=a.selector+"page-"+c,v;if(!(0<b(document.getElementById(a.ID+"page-"+c)).length))for(v in b(document.getElementById(a.ID+
"inner")).append('<div id="'+a.ID+"page-"+c+'" style="top: '+f+"px; width: "+e+"px; height: "+g+'px;" class="diva-document-page" title="Page '+(c+1)+'" data-index="'+c+'" data-filename="'+d+'">'+a.pageTools+"</div>"),k(a.onPageLoad,c,d,h),diva.Events.publish("PageWillLoad",[c,d,h]),a.plugins)k(a.plugins[v].onPageLoad,c,d,h);a.pageTimeouts.push(setTimeout(function(){if(n(c)){var f=a.imageDir+"/",v=m(c,"r"),x=m(c,"c"),y=[],I=!0,R=0,J=g-(v-1)*a.tileHeight,Q=e-(x-1)*a.tileWidth,A,Y,K,q,N,t;baseImageURL=
a.iipServerURL+"?FIF="+f+d+"&JTL="+(a.zoomLevel+a.pages[c].m-a.realMaxZoom)+",";for(f=0;f<v;){for(A=0;A<x;){q=f*a.tileHeight;N=A*a.tileWidth;Y=f===v-1?J:a.tileHeight;K=A===x-1?Q:a.tileWidth;t=baseImageURL+R;if(!(0<b(a.selector+"tile-"+c+"-"+R).length)){var p=a.heightAbovePages[c]+f*a.tileHeight+a.verticalPadding,z=a.pageLeftOffsets[c]+A*a.tileWidth,r=z+a.tileWidth;if(p=l(p,p+a.tileHeight))var p=a.leftScrollSoFar-a.viewportMargin,u=p+a.panelWidth+2*a.viewportMargin,s=r>=p&&r<=u,r=z<=p&&r>=u,p=z>=p&&
z<=u||r||s;p?y.push('<div id="'+a.ID+"tile-"+c+"-"+R+'" class="diva-document-tile" style="display:inline; position: absolute; top: '+q+"px; left: "+N+"px; background-image: url('"+t+"'); height: "+Y+"px; width: "+K+'px;"></div>'):I=!1}R++;A++}f++}a.allTilesLoaded[c]=I;b(document.getElementById(a.ID+"page-"+c)).append(y.join(""));k(a.onPageLoaded,c,d,h);diva.Events.publish("PageDidLoad",[c,d,h])}},a.pageLoadTimeout))}},s=function(c){b(document.getElementById(a.ID+"page-"+c)).empty().remove()},r=function(b,
c){0<c?f(b)&&(n(b)?(q(b),a.lastPageLoaded=b,r(a.lastPageLoaded+1,c)):a.heightAbovePages[b]+m(b,"h")+a.verticalPadding<a.topScrollSoFar&&r(b+1,c)):f(b)&&(n(b)?(q(b),a.firstPageLoaded=b,r(a.firstPageLoaded-1,c)):a.heightAbovePages[b]>a.topScrollSoFar+a.panelHeight&&r(b-1,c))},L=function(b,c){0<c?f(b)&&a.heightAbovePages[b]+m(b,"h")+a.verticalPadding<a.topScrollSoFar&&(s(b),a.firstPageLoaded=b+1,L(a.firstPageLoaded,c)):f(b)&&a.heightAbovePages[b]>a.topScrollSoFar+a.panelHeight&&(s(b),a.lastPageLoaded=
b-1,L(a.lastPageLoaded,c))},t=function(b){return 0<=b&&b<a.numRows},p=function(b){b*=a.rowHeight;return l(b,b+a.rowHeight+a.fixedPadding)},w=function(c){if(!(0<b(a.selector+"row-"+c).length)){var d=[];d.push('<div class="diva-row" id="'+a.ID+"row-"+c+'" style="height: '+a.rowHeight+"; top: "+(a.rowHeight*c+a.fixedPadding)+'px;">');var e,g,k,h,v,l,x=a.imageDir+"/",y=a.pagesPerRow;for(e=0;e<y;e++){g=c*a.pagesPerRow+e;if(!f(g))break;k=a.pages[g].f;h=m(g,"w");v=m(g,"h");l=a.fixedHeightGrid?(a.rowHeight-
a.fixedPadding)*h/v:a.gridPageWidth;h=a.fixedHeightGrid?a.rowHeight-a.fixedPadding:l/h*v;v=parseInt(e*(a.fixedPadding+a.gridPageWidth)+a.fixedPadding,10);l=parseInt(l,10);h=parseInt(h,10);v+=a.fixedHeightGrid?(a.gridPageWidth-l)/2:0;k=a.iipServerURL+"?FIF="+x+k+"&amp;HEI="+(h+2)+"&amp;CVT=JPEG";d.push('<div id="'+a.ID+"page-"+g+'" class="diva-page" style="width: '+l+"px; height: "+h+"px; left: "+v+'px;" title="Page '+(g+1)+'"></div>');H(c,g,k,l,h)}d.push("</div>");b(document.getElementById(a.ID+"inner")).append(d.join(""))}},
u=function(c){b(document.getElementById(a.ID+"row-"+c)).empty().remove()},F=function(b,c){0<c?t(b)&&(p(b)?(w(b),a.lastRowLoaded=b,F(a.lastRowLoaded+1,c)):a.rowHeight*(b+1)<a.topScrollSoFar&&F(b+1,c)):t(b)&&(p(b)?(w(b),a.firstRowLoaded=b,F(a.firstRowLoaded-1,c)):a.rowHeight*b>a.topScrollSoFar+a.panelHeight&&F(b-1,c))},G=function(b,c){0<c?t(b)&&a.rowHeight*(b+1)<a.topScrollSoFar&&(u(b),a.firstRowLoaded++,G(a.firstRowLoaded,c)):t(b)&&a.rowHeight*b>a.topScrollSoFar+a.panelHeight&&(u(b),a.lastRowLoaded--,
G(a.lastRowLoaded,c))},H=function(c,d,e,g,f){a.pageTimeouts.push(setTimeout(function(){p(c)&&b(a.selector+"page-"+d).html('<img src="'+e+'" style="width: '+g+"px; height: "+f+'px;" />')},a.rowLoadTimeout))},v=function(b){var c=a.topScrollSoFar+a.panelHeight/2,d=a.currentPageIndex,e=a.currentPageIndex+b,g=!1;0>b?0<=e&&a.heightAbovePages[e]+m(e,"h")+a.verticalPadding>=c&&(g=!0):0<b&&a.heightAbovePages[d]+m(d,"h")+a.verticalPadding<c&&(g=!0);return g?(a.currentPageIndex=e,0===b||v(b)||(b=a.pages[e].f,
k(a.onSetCurrentPage,e,b),diva.Events.publish("VisiblePageDidChange",[e,b])),!0):!1},I=function(b){var c=Math.floor(a.currentPageIndex/a.pagesPerRow),d=c+parseInt(b,10),e=a.topScrollSoFar+a.panelHeight/2,g=!1;0>b?0<=d&&(a.rowHeight*c>=e||a.rowHeight*d>=a.topScrollSoFar)&&(g=!0):0<b&&a.rowHeight*(c+1)<a.topScrollSoFar&&t(d)&&(g=!0);return g?(a.currentPageIndex=d*a.pagesPerRow,0===b||I(b)||(b=a.currentPageIndex,diva.Events.publish("VisiblePageDidChange",[b,a.pages[b].f])),!0):!1},y=function(c,d,e){d=
"undefined"!==typeof d?d:0;e=(a.maxWidths[a.zoomLevel]-a.panelWidth)/2+a.horizontalPadding+("undefined"!==typeof e?e:0);var g=parseInt(b.getHashParam("y"+a.hashParamSuffix),10),f=a.heightAbovePages[c+1]-a.heightAbovePages[c]-a.verticalPadding,h=a.heightAbovePages[c];d=isNaN(g)?h+d:h+a.verticalPadding+f/2-a.panelHeight/2+d;b(a.outerSelector).scrollTop(d);b(a.outerSelector).scrollLeft(e);a.currentPageIndex=c;d=a.pages[c].f;k(a.onSetCurrentPage,c,d);diva.Events.publish("VisiblePageDidChange",[c,d]);
k(a.onJump,c);diva.Events.publish("ViewerDidJump",[c])},x=function(c){var d=Math.floor(c/a.pagesPerRow)*a.rowHeight;b(a.outerSelector).scrollTop(d);a.currentPageIndex=c;diva.Events.publish("VisiblePageDidChange",[c,a.pages[c].f])},Q=function(b){return b>=a.minZoomLevel&&b<=a.maxZoomLevel?b:a.minZoomLevel},A=function(b){return b>=a.minPagesPerRow&&b<=a.maxPagesPerRow?b:a.maxPagesPerRow},N=function(){a.allTilesLoaded=[];b(a.outerSelector).scrollTop(0);a.topScrollSoFar=0;b(a.innerSelector).empty();a.firstPageLoaded=
0;a.firstRowLoaded=-1;a.previousTopScroll=0;for(clearTimeout(a.resizeTimer);a.pageTimeouts.length;)clearTimeout(a.pageTimeouts.pop())},z=function(){a.inGrid?K():J()},J=function(){N();a.zoomLevel=Q(a.zoomLevel);var c=a.zoomLevel;0<a.adaptivePadding?(a.horizontalPadding=a.averageWidths[c]*a.adaptivePadding,a.verticalPadding=a.averageHeights[c]*a.adaptivePadding):(a.horizontalPadding=a.fixedPadding,a.verticalPadding=a.fixedPadding);a.pageTools.length&&(a.verticalPadding=Math.max(40,a.horizontalPadding));
a.totalHeight=a.totalHeights[c]+a.verticalPadding*(a.numPages+1);a.dimAfterZoom=a.totalHeight;var d=Math.max(a.maxWidths[c]+2*a.horizontalPadding,a.panelWidth),e=0,g;for(g=0;g<a.numPages;g++)a.heightAbovePages[g]=e,e=a.heightAbovePages[g]+m(g,"h")+a.verticalPadding,a.pageLeftOffsets[g]=(d-m(g,"w"))/2,n(g)&&(q(g),a.lastPageLoaded=g);0<=a.oldZoomLevel&&(a.oldZoomLevel<a.zoomLevel?(k(a.onZoomIn,c),diva.Events.publish("ViewerDidZoomIn",c)):(k(a.onZoomOut,c),diva.Events.publish("ViewerDidZoomOut",c)),
k(a.onZoom,c));b(a.innerSelector).height(Math.round(a.totalHeight));b(a.innerSelector).width(Math.round(d));a.preZoomOffset?(d=a.preZoomOffset.i,c=a.heightAbovePages[d]+a.verticalPadding,e=a.pageLeftOffsets[d],d=Math.pow(2,a.zoomLevel-a.oldZoomLevel),e=a.preZoomOffset.x*d-(a.preZoomOffset.originalX-a.viewerXOffset)+e,c=a.preZoomOffset.y*d-(a.preZoomOffset.originalY-a.viewerYOffset)+c,b(a.outerSelector).scrollTop(c).scrollLeft(e),a.preZoomOffset=void 0):(f(a.goDirectlyTo)||(a.goDirectlyTo=0),y(a.goDirectlyTo,
a.verticalOffset,a.horizontalOffset),a.horizontalOffset=0,a.verticalOffset=0);a.scaleWait&&(a.scaleWait=!1);c=a.pages[a.currentPageIndex].f;k(a.onDocumentLoaded,a.lastPageLoaded,c);diva.Events.publish("DocumentDidLoad",[a.lastPageLoaded,c])},K=function(){N();a.pagesPerRow=A(a.pagesPerRow);var c=(a.panelWidth-a.fixedPadding*(a.pagesPerRow+1))/a.pagesPerRow;a.gridPageWidth=c;a.rowHeight=a.fixedHeightGrid?a.fixedPadding+a.minRatio*c:a.fixedPadding+a.maxRatio*c;a.numRows=Math.ceil(a.numPages/a.pagesPerRow);
a.totalHeight=a.numRows*a.rowHeight+a.fixedPadding;b(a.innerSelector).height(Math.round(a.totalHeight));b(a.innerSelector).width(Math.round(a.panelWidth));x(a.goDirectlyTo);for(var d,e=a.numPages,c=0;c<e;c+=a.pagesPerRow)d=Math.floor(c/a.pagesPerRow),p(d)&&(a.firstRowLoaded=0>a.firstRowLoaded?d:a.firstRowLoaded,w(d),a.lastRowLoaded=d)},V=function(c){if(0<=a.oldZoomLevel&&!a.inGrid){var d=b(a.selector+"page-"+a.currentPageIndex).offset(),e=-(d.top-a.verticalPadding-a.viewerYOffset),g=(a.panelWidth-
m(a.currentPageIndex,"w"))/2,d=-(d.left-a.viewerXOffset-g);a.verticalOffset=e;a.horizontalOffset=d}b(a.outerSelector).toggleClass("diva-fullscreen");b("body").toggleClass("diva-hide-scrollbar");b(a.parentSelector).toggleClass("diva-full-width");e=a.mobileWebkit?parseInt(b("body").css("margin")):0;e=a.inFullscreen?"0px":a.enableAutoWidth?(a.viewerWidthPadding-e).toString()+"px":"";b(a.outerSelector).css("margin-left",e);a.panelHeight=b(a.outerSelector).height();a.panelWidth=b(a.outerSelector).width()-
a.scrollbarWidth;b(a.innerSelector).width(a.panelWidth);a.viewerXOffset=b(a.outerSelector).offset().left;a.viewerYOffset=b(a.outerSelector).offset().top;c?(a.inGrid=!a.inGrid,O()):z();a.inFullscreen||(a.mobileWebkit?T():U());k(a.onModeToggle,a.inFullscreen);diva.Events.publish("ModeDidSwitch",[a.inFullscreen])},O=function(){z();k(a.onViewToggle,a.inGrid);diva.Events.publish("ViewDidSwitch",[a.inGrid])},S=function(){a.goDirectlyTo=a.currentPageIndex;a.inFullscreen=!a.inFullscreen;V(!1)},P=function(){a.goDirectlyTo=
a.currentPageIndex;a.inGrid=!a.inGrid;O()},Z=function(c){var d=b(this).offset();a.preZoomOffset={x:c.pageX-d.left,y:c.pageY-d.top,originalX:c.pageX,originalY:c.pageY,i:b(this).attr("data-index")};M(c.ctrlKey?a.zoomLevel-1:a.zoomLevel+1)},M=function(b){var c=Q(b);if(c!==b)return!1;a.oldZoomLevel=a.zoomLevel;a.zoomLevel=c;diva.Events.publish("ZoomLevelDidChange",null);J();return!0},B=function(b){var c=A(b);if(c!==b)return!1;a.oldPagesPerRow=a.zoomLevel;a.pagesPerRow=c;diva.Events.publish("GridRowNumberDidChange",
null);a.goDirectlyTo=a.currentPageIndex;K()},C=function(){var b=a.inFullscreen,c=a.inGrid,d=a.zoomLevel,e=a.pagesPerRow,g=a.enableFilename?a.pages[a.currentPageIndex].f:!1,f=a.enableFilename?!1:a.currentPageIndex+1,k;a.inGrid?k=!1:(k=document.getElementById(a.ID+"outer").scrollTop,k=parseInt(k-a.heightAbovePages[a.currentPageIndex]-(a.heightAbovePages[a.currentPageIndex+1]-a.heightAbovePages[a.currentPageIndex]-a.verticalPadding)/2+a.panelHeight/2-a.verticalPadding,10));var h;a.inGrid?h=!1:(h=(a.maxWidths[a.zoomLevel]+
2*a.horizontalPadding-a.panelWidth)/2,h=document.getElementById(a.ID+"outer").scrollLeft-h,h=parseInt(h,10));return{f:b,g:c,z:d,n:e,i:g,p:f,y:k,x:h}},D=function(){var b=C(),c=[],d;for(d in b)!1!==b[d]&&c.push(d+a.hashParamSuffix+"="+b[d]);return c.join("&")},E=function(){return location.protocol+"//"+location.host+location.pathname+"#"+D()},T=function(){a.panelHeight=window.innerHeight-a.viewerYOffset-a.viewerHeightPadding;a.panelWidth=a.enableAutoWidth?window.innerWidth-2*a.viewerWidthPadding:window.innerWidth;
a.enableAutoHeight&&(document.getElementById(a.ID+"outer").style.height=a.panelHeight+"px");a.enableAutoWidth&&(document.getElementById(a.ID+"outer").style.width=a.panelWidth+"px")},U=function(){var c,d;a.divaIsFullWindow?(d=b(window).innerWidth(),c=b(window).innerHeight()):(d=b(a.parentSelector).parent().innerWidth(),c=b(a.parentSelector).parent().innerHeight());a.enableAutoHeight&&b(a.parentSelector).height(c*a.heightProportion);a.enableAutoWidth&&b(a.parentSelector).width(d*a.widthProportion);
d=b(a.parentSelector).offset();c=d.top;d=d.left;var e=b(a.outerSelector).offset();a.viewerYOffset=e.top-c;a.viewerXOffset=e.left-d;d=parseInt(b(a.outerSelector).css("border-top-width"))+parseInt(b(a.outerSelector).css("border-bottom-width"));c=b(a.parentSelector).height();newHeight=c-a.viewerYOffset-d;c=parseInt(b(a.outerSelector).css("border-left-width"))+parseInt(b(a.outerSelector).css("border-right-width"));d=b(a.parentSelector).width();newWidth=a.enableAutoWidth?d-2*a.viewerWidthPadding-c-a.scrollbarWidth:
b(a.outerSelector).width()-a.scrollbarWidth;return newWidth!==a.panelWidth||newHeight!==a.panelHeight?(b(a.outerSelector).height(newHeight),b(a.outerSelector).width(newWidth+a.scrollbarWidth),a.panelWidth=newWidth,a.panelHeight=newHeight,!0):!1},aa=function(){b(a.outerSelector+", "+a.innerSelector).dragscrollable({dragSelector:".diva-dragger",acceptPropagatedEvent:!0});b(a.outerSelector).on("dblclick",".diva-document-page",function(a){Z.call(this,a)});b(a.outerSelector).on("contextmenu",".diva-document-page",
function(b){if(b.ctrlKey)return clearTimeout(a.singleClickTimeout),a.singleClick?(Z.call(this,b),a.singleClick=!1):(a.singleClick=!0,a.singleClickTimeout=setTimeout(function(){a.singleClick=!1},500)),!1});b(a.outerSelector).on("dblclick",".diva-row",function(b){var c=document.getElementById(a.ID+"outer");a.goDirectlyTo=Math.floor((b.pageY-a.viewerYOffset+c.scrollTop)/a.rowHeight)*a.pagesPerRow+Math.floor((b.pageX-a.viewerXOffset+c.scrollLeft)/(a.panelWidth/a.pagesPerRow));a.inGrid=!1;O()})},ca=function(){b(a.innerSelector).mouseover(function(){b(this).removeClass("diva-grabbing").addClass("diva-grab")});
b(a.innerSelector).mouseout(function(){b(this).removeClass("diva-grab")});b(a.innerSelector).mousedown(function(){b(this).removeClass("diva-grab").addClass("diva-grabbing")});b(a.innerSelector).mouseup(function(){b(this).removeClass("diva-grabbing").addClass("diva-grab")});aa();b(a.outerSelector).scroll(function(){a.topScrollSoFar=document.getElementById(a.ID+"outer").scrollTop;var c=a.topScrollSoFar-a.previousTopScroll;if(a.inGrid)0>c?(F(a.firstRowLoaded,-1),I(-1),G(a.lastRowLoaded,-1)):0<c&&(F(a.lastRowLoaded,
1),I(1),G(a.firstRowLoaded,1)),k(a.onScroll,a.topScrollSoFar),diva.Events.publish("ViewerDidScroll",[a.topScrollSoFar]),0<c?(k(a.onScrollDown,a.topScrollSoFar),diva.Events.publish("ViewerDidScrollDown",[a.topScrollSoFar])):0>c&&(k(a.onScrollUp,a.topScrollSoFar),diva.Events.publish("ViewerDidScrollUp",[a.topScrollSoFar]));else{var d;if(0>c)r(a.firstPageLoaded,c),v(-1),L(a.lastPageLoaded,c);else if(0<c)r(a.lastPageLoaded,c),v(1),L(a.firstPageLoaded,c);else{var e=a.lastPageLoaded;for(d=Math.max(a.firstPageLoaded,
0);d<=e;d++)n(d)&&q(d)}k(a.onScroll,a.topScrollSoFar);diva.Events.publish("ViewerDidScroll",[a.topScrollSoFar]);0<c?(k(a.onScrollDown,a.topScrollSoFar),diva.Events.publish("ViewerDidScrollDown",[a.topScrollSoFar])):0>c&&(k(a.onScrollUp,a.topScrollSoFar),diva.Events.publish("ViewerDidScrollUp",[a.topScrollSoFar]));a.leftScrollSoFar=b(this).scrollLeft()}a.previousTopScroll=a.topScrollSoFar});if(a.mobileWebkit){var c=[];c.push('<meta name="viewport" content="user-scalable=no, width=device-width, initial-scale=1, maximum-scale=1" />');
c.push('<meta name="apple-mobile-web-app-capable" content="yes" />');c.push('<meta name="apple-mobile-web-app-status-bar-style" content="black" />');b("head").append(c.join("\n"));a.blockMobileMove&&b("body").bind("touchmove",function(a){a.originalEvent.preventDefault();return!1});b("body").bind("gestureend",function(b){b=b.originalEvent;if(!a.scaleWait)if(a.goDirectlyTo=a.currentPageIndex,a.inGrid)a.inGrid=!1,O();else a:{var c=a.zoomLevel;if(1<b.scale&&c<a.maxZoomLevel)c++;else if(1>b.scale&&c>a.minZoomLevel)c--;
else break a;a.scaleWait=!0;M(c)}return!1});b(window).bind("orientationchange",function(b){a.orientationChange=!0;T();a.goDirectlyTo=a.currentPageIndex;z()});b(a.outerSelector).kinetic()}if(a.enableSpaceScroll||a.enableKeyScroll){var d=b.ui.keyCode.UP,e=b.ui.keyCode.DOWN,g=b.ui.keyCode.LEFT,f=b.ui.keyCode.RIGHT,h=b.ui.keyCode.SPACE,l=b.ui.keyCode.PAGE_UP,m=b.ui.keyCode.PAGE_DOWN,x=b.ui.keyCode.HOME,y=b.ui.keyCode.END;b(document).keydown(function(c){if(a.enableSpaceScroll&&c.keyCode===h||a.enableKeyScroll&&
c.keyCode===m)return b(a.outerSelector).scrollTop(a.topScrollSoFar+a.panelHeight),!1;if(a.enableKeyScroll&&c.keyCode===l)return b(a.outerSelector).scrollTop(a.topScrollSoFar-a.panelHeight),!1;if(a.enableKeyScroll&&c.keyCode===d)return b(a.outerSelector).scrollTop(a.topScrollSoFar-a.arrowScrollAmount),!1;if(a.enableKeyScroll&&c.keyCode===e)return b(a.outerSelector).scrollTop(a.topScrollSoFar+a.arrowScrollAmount),!1;if(a.enableKeyScroll&&c.keyCode===g)return b(a.outerSelector).scrollLeft(a.leftScrollSoFar-
a.arrowScrollAmount),!1;if(a.enableKeyScroll&&c.keyCode===f)return b(a.outerSelector).scrollLeft(a.leftScrollSoFar+a.arrowScrollAmount),!1;if(a.enableKeyScroll&&c.keyCode===x)return b(a.outerSelector).scrollTop(0),!1;if(a.enableKeyScroll&&c.keyCode===y)return b(a.outerSelector).scrollTop(a.totalHeight),!1});a.mobileWebkit||b(window).resize(function(){var b;a.inFullscreen?(a.panelWidth=window.innerWidth-a.scrollbarWidth,a.panelHeight=window.innerHeight,b=!0):b=U();b&&(clearTimeout(a.resizeTimer),a.resizeTimer=
setTimeout(function(){a.goDirectlyTo=a.currentPageIndex;z()},200))})}},da=function(){var c='<div id="'+a.ID+'tools-left" class="diva-tools-left">'+("slider"===a.enableZoomControls?'<div id="'+a.ID+'zoom-slider"></div>':"")+("buttons"===a.enableZoomControls?'<div id="'+a.ID+'zoom-out-button" class="diva-zoom-out-button zoom-button" title="Zoom Out"></div><div id="'+a.ID+'zoom-in-button" class="diva-zoom-in-button zoom-button" title="Zoom In"></div>':"")+("slider"===a.enableGridControls?'<div id="'+
a.ID+'grid-slider"></div>':"")+("buttons"===a.enableGridControls?'<div id="'+a.ID+'grid-out-button" class="diva-grid-out-button grid-button" title="Zoom Out"></div><div id="'+a.ID+'grid-in-button" class="diva-grid-in-button grid-button" title="Zoom In"></div>':"")+("slider"===a.enableZoomControls?'<div id="'+a.ID+'zoom-slider-label" class="diva-slider-label">Zoom level: <span id="'+a.ID+'zoom-level">'+a.zoomLevel+"</span></div>":"")+("buttons"===a.enableZoomControls?'<div id="'+a.ID+'zoom-buttons-label" class="diva-buttons-label">Zoom level: <span id="'+
a.ID+'zoom-level">'+a.zoomLevel+"</span></div>":"")+("slider"===a.enableGridControls?'<div id="'+a.ID+'grid-slider-label" class="diva-slider-label">Pages per row: <span id="'+a.ID+'pages-per-row">'+a.pagesPerRow+"</span></div>":"")+("buttons"===a.enableGridControls?'<div id="'+a.ID+'grid-buttons-label" class="diva-buttons-label">Pages per row: <span id="'+a.ID+'pages-per-row">'+a.pagesPerRow+"</span></div>":"")+'</div><div id="'+a.ID+'tools-right" class="diva-tools-right">'+(a.enableFullscreen?'<div id="'+
a.ID+'fullscreen" class="diva-fullscreen-icon" title="Toggle fullscreen mode"></div>':"")+(a.enableLinkIcon?'<div class="diva-link-icon" id="'+a.ID+'link-icon" style="'+(a.enableGridIcon?"border-left: 0px":"")+'" title="Link to this page"></div>':"")+(a.enableGridIcon?'<div class="diva-grid-icon'+(a.inGrid?" diva-in-grid":"")+'" id="'+a.ID+'grid-icon" title="Toggle grid view"></div>':"")+'<div class="diva-page-nav">'+(a.enableGotoPage?'<form id="'+a.ID+'goto-page" class="diva-goto-form"><input type="text" id="'+
a.ID+'goto-page-input" / class="diva-input"> <input type="submit" value="Go" style="margin-top: 0px;" /></form>':"")+('<div class="diva-page-label">Page <span id="'+a.ID+'current-page">1</span> of <span id="'+a.ID+'num-pages">'+a.numPages+"</span></div>")+"</div></div>";a.toolbarParentSelector?b(a.toolbarParentSelector).prepend('<div id="'+a.ID+'tools" class="diva-tools">'+c+"</div>"):b(a.parentSelector).prepend('<div id="'+a.ID+'tools" class="diva-tools">'+c+"</div>");b(a.selector+"zoom-slider").slider({value:a.zoomLevel,
min:a.minZoomLevel,max:a.maxZoomLevel,step:1,slide:function(c,d){var e=a.currentPageIndex;a.goDirectlyTo=e;var g=Math.pow(2,d.value-a.zoomLevel),f=a.maxWidths[a.zoomLevel]+2*a.horizontalPadding,h=b(a.outerSelector).scrollLeft()-(f-a.panelWidth)/2;a.horizontalOffset=f>a.panelWidth?h*g:0;a.verticalOffset=g*(b(a.outerSelector).scrollTop()-a.heightAbovePages[e]);M(d.value)},change:function(b,c){c.value!==a.zoomLevel&&M(c.value)},stop:function(a,c){b(".ui-slider-handle").blur()}});var d=function(c){var d=
a.currentPageIndex;a.goDirectlyTo=d;var e=Math.pow(2,a.zoomLevel-1-a.zoomLevel),g=a.maxWidths[a.zoomLevel]+2*a.horizontalPadding,f=b(a.outerSelector).scrollLeft()-(g-a.panelWidth)/2;a.horizontalOffset=g>a.panelWidth?f*e:0;a.verticalOffset=e*(b(a.outerSelector).scrollTop()-a.heightAbovePages[d]);M(a.zoomLevel+c)};b(a.selector+"zoom-out-button").click(function(){d(-1)});b(a.selector+"zoom-in-button").click(function(){d(1)});b(a.selector+"grid-slider").slider({value:a.pagesPerRow,min:a.minPagesPerRow,
max:a.maxPagesPerRow,step:1,slide:function(a,b){B(b.value)},change:function(b,c){c.value!==a.pagesPerRow&&B(c.value)}});b(a.selector+"fullscreen").click(function(){S()});b(a.selector+"grid-out-button").click(function(){B(a.pagesPerRow+1)});b(a.selector+"grid-in-button").click(function(){B(a.pagesPerRow-1)});b(a.selector+"grid-icon").click(function(){P()});b(a.selector+"goto-page").submit(function(){var c=parseInt(b(a.selector+"goto-page-input").val(),10)-1;f(c)?a.inGrid?x(c):y(c,0,0):alert("Invalid page number");
return!1});b(a.selector+"link-icon").click(function(){b("body").prepend('<div id="'+a.ID+'link-popup" class="diva-link-popup"><input id="'+a.ID+'link-popup-input" class="diva-input" type="text" value="'+E()+'"/></div>');if(a.inFullscreen)b(a.selector+"link-popup").addClass("in-fullscreen");else{var c=b(a.outerSelector).offset().left+a.panelWidth,c=c+(a.scrollbarWidth-240-1),d=b(a.outerSelector).offset().top+1;b(a.selector+"link-popup").removeClass("in-fullscreen").css({top:d+"px",left:c+"px"})}b("body").mouseup(function(c){c=
c.target.id;c!==a.ID+"link-popup"&&c!==a.ID+"link-popup-input"&&b(a.selector+"link-popup").remove()});b(a.outerSelector).scroll(function(){b(a.selector+"link-popup").remove()});b(a.selector+"link-popup input").click(function(){b(this).focus().select()});return!1});var e=a.inGrid?"grid":"zoom";b(a.selector+e+"-slider").show();b(a.selector+e+"-out-button").show();b(a.selector+e+"-in-button").show();b(a.selector+e+"-slider-label").show();b(a.selector+e+"-buttons-label").show();return{updateCurrentPage:function(){b(a.selector+
"current-page").text(a.currentPageIndex+1)},setNumPages:function(c){b(a.selector+"num-pages").text(c)},updateZoomSlider:function(){a.zoomLevel!==b(a.selector+"zoom-slider").slider("value")&&b(a.selector+"zoom-slider").slider({value:a.zoomLevel});b(a.selector+"zoom-level").text(a.zoomLevel)},updateZoomButtons:function(){b(a.selector+"zoom-level").text(a.zoomLevel)},updateGridSlider:function(){a.pagesPerRow!==b(a.selector+"grid-slider").slider("value")&&b(a.selector+"grid-slider").slider({value:a.pagesPerRow});
b(a.selector+"pages-per-row").text(a.pagesPerRow)},updateGridButtons:function(){b(a.selector+"pages-per-row").text(a.pagesPerRow)},switchView:function(){b(a.selector+e+"-slider").hide();b(a.selector+e+"-out-button").hide();b(a.selector+e+"-in-button").hide();b(a.selector+e+"-slider-label").hide();b(a.selector+e+"-buttons-label").hide();e=a.inGrid?"grid":"zoom";b(a.selector+e+"-slider").show();b(a.selector+e+"-out-button").show();b(a.selector+e+"-in-button").show();b(a.selector+e+"-slider-label").show();
b(a.selector+e+"-buttons-label").show();b(a.selector+"grid-icon").toggleClass("diva-in-grid")},switchMode:function(){b(a.selector+"tools").toggleClass("diva-fullscreen-tools");a.inFullscreen?(b(a.selector+"tools-right").after(b(a.selector+"tools-left")),b(a.selector+"tools-left").addClass("in-fullscreen")):(b(a.selector+"tools-left").after(b(a.selector+"tools-right")),b(a.selector+"tools-left").removeClass("in-fullscreen"))}}},ea=function(){if(window.divaPlugins){var c=[];b.each(window.divaPlugins,
function(d,f){var h=f.pluginName[0].toUpperCase()+f.pluginName.substring(1);a["enable"+h]&&f.init(a,e)&&(h=f.titleText||h+" plugin","function"===typeof f.handleClick&&(c.push('<div class="diva-'+f.pluginName+'-icon" title="'+h+'"></div>'),b(a.outerSelector).delegate(".diva-"+f.pluginName+"-icon","click",function(b){f.handleClick.call(this,b,a)})),a.plugins.push(f))});c.length&&(a.pageTools='<div class="diva-page-tools">'+c.join("")+"</div>")}},ba=function(){clearTimeout(a.throbberTimeoutID);b(a.selector+
"throbber").hide()},fa=function(){var c='<div id="'+a.ID+'throbber" class="diva-throbber"></div>';b(a.outerSelector).append(c);a.throbberTimeoutID=setTimeout(function(){b(a.selector+"throbber").show()},a.throbberTimeout);b.ajax({url:a.objectData,cache:!0,dataType:"json",error:function(c,d,e){ba();c='<div id="'+a.ID+'error" class="diva-error"><p><strong>Error</strong></p><p>Invalid objectData. Error code: '+d+" "+e+"</p>";0===a.objectData.lastIndexOf("http",0)&&""===e&&(e=a.objectData.replace(/https?:\/\//i,
"").split(/[/?#]/)[0],location.hostname!==e&&(c+='<p>Attempted to access cross-origin data without CORS.</p><p>You may need to update your server configuration to support CORS. For help, see the <a href="https://github.com/DDMAL/diva.js/wiki/Installation#a-note-about-cross-site-requests" target="_blank">cross-site request documentation.</a></p>'));c+="</div>";b(a.outerSelector).append(c)},success:function(c,d,e){ba();a.pages=c.pgs;a.maxRatio=c.dims.max_ratio;a.minRatio=c.dims.min_ratio;a.itemTitle=
c.item_title;a.numPages=c.pgs.length;a.maxWidths=c.dims.max_w;a.averageWidths=c.dims.a_wid;a.averageHeights=c.dims.a_hei;a.totalHeights=c.dims.t_hei;a.realMaxZoom=c.max_zoom;a.maxZoomLevel=0<=a.maxZoomLevel&&a.maxZoomLevel<=c.max_zoom?a.maxZoomLevel:c.max_zoom;a.minZoomLevel=0<=a.minZoomLevel&&a.minZoomLevel<=a.maxZoomLevel?a.minZoomLevel:0;a.minPagesPerRow=Math.max(2,a.minPagesPerRow);a.maxPagesPerRow=Math.max(a.minPagesPerRow,a.maxPagesPerRow);a.enableFilename?(c=b.getHashParam("i"+a.hashParamSuffix),
c=h(c)):c=parseInt(b.getHashParam("p"+a.hashParamSuffix),10)-1;f(c)&&(a.goDirectlyTo=c);b.each(a.plugins,function(b,c){k(c.setupHook,a)});a.enableToolbar&&(a.toolbar=da(),diva.Events.subscribe("VisiblePageDidChange",a.toolbar.updateCurrentPage),diva.Events.subscribe("ModeDidSwitch",a.toolbar.switchMode),diva.Events.subscribe("ViewDidSwitch",a.toolbar.switchView),diva.Events.subscribe("ZoomLevelDidChange",a.toolbar.updateZoomSlider),diva.Events.subscribe("ZoomLevelDidChange",a.toolbar.updateZoomButtons),
diva.Events.subscribe("GridRowNumberDidChange",a.toolbar.updateGridSlider),diva.Events.subscribe("ZoomLevelDidChange",a.toolbar.updateGridButtons));b(a.selector+"current label").text(a.numPages);a.enableAutoTitle&&b(a.parentSelector).prepend('<div id="'+a.ID+'title" class="diva-title">'+a.itemTitle+"</div>");b(a.parentSelector).parent()[0]!==document.body||b(a.parentSelector).siblings().not("#diva-canvas-backdrop")[0]||(a.divaIsFullWindow=!0);a.mobileWebkit?T():(a.divaIsFullWindow?(a.widthProportion=
b(a.parentSelector).width()/b(window).innerWidth(),a.heightProportion=Math.min(.9,b(a.parentSelector).height()/b(window).innerHeight())):(a.widthProportion=b(a.parentSelector).width()/b(a.parentSelector).parent().innerWidth(),a.heightProportion=b(a.parentSelector).height()/b(a.parentSelector).parent().innerHeight()),U());c=b(a.outerSelector).offset();a.viewerXOffset=c.left;a.viewerYOffset=c.top;a.enableAutoWidth&&(a.mobileWebkit?(c=parseInt(b("body").css("margin")),b(a.outerSelector).css("margin-left",
a.viewerWidthPadding-c)):b(a.outerSelector).css("margin-left",a.viewerWidthPadding));a.inFullscreen?V(!1):z();k(a.onReady,a);diva.Events.publish("ViewerDidLoad",[a]);a.loaded=!0}})},W=function(){return a.loaded?!0:(console.warn("The viewer is not completely initialized. This is likely because it is still downloading data. To fix this, only call this function if the isReady() method returns true."),!1)};(function(){a.scrollbarWidth=b.getScrollbarWidth();a.mobileWebkit=void 0!==window.orientation;a.ID=
b.generateId("diva-");a.selector="#"+a.ID;var c=parseInt(a.ID,10);1<c&&(a.hashParamSuffix=c);a.outerSelector=a.selector+"outer";a.innerSelector=a.selector+"inner";b(a.parentSelector).append('<div id="'+a.ID+'outer" class="diva-outer"></div>');b(a.outerSelector).append('<div id="'+a.ID+'inner" class="diva-inner diva-dragger"></div>');c=parseInt(b.getHashParam("n"+a.hashParamSuffix),10);c>=a.minPagesPerRow&&c<=a.maxPagesPerRow&&(a.pagesPerRow=c);c=b.getHashParam("z"+a.hashParamSuffix);""!==c&&(c=parseInt(c,
10),c>=a.minZoomLevel&&(a.zoomLevel=c));c=parseInt(b.getHashParam("y"+a.hashParamSuffix),10);isNaN(c)||(a.verticalOffset=c);c=parseInt(b.getHashParam("x"+a.hashParamSuffix),10);isNaN(c)||(a.horizontalOffset=c);var c=b.getHashParam("g"+a.hashParamSuffix),d="true"===c,e=b.getHashParam("f"+a.hashParamSuffix);a.inGrid=a.inGrid&&"false"!==c||d;a.inFullscreen=a.inFullscreen&&"false"!==e||"true"===e;a.minHeight=parseInt(b(a.outerSelector).css("min-height"),10);a.minWidth=parseInt(b(a.outerSelector).css("min-width"),
10);fa();ea();ca()})();this.getItemTitle=function(){return a.itemTitle};this.gotoPageByNumber=function(a){a-=1;return f(a)?(y(a,0,0),!0):!1};this.gotoPageByIndex=function(a){return f(a)?(y(a,0,0),!0):!1};this.getCurrentPage=function(){console.warn("The call to getCurrentPage is deprecated. Use getCurrentPageIndex instead.");return a.currentPageIndex};this.getNumberOfPages=function(){return W()?a.numPages:!1};this.getPageDimensionsAtZoomLevel=function(b,c){if(!W())return!1;c>a.maxZoomLevel&&(c=a.maxZoomLevel);
var d=a.pages[b].d[parseInt(c,10)];return{width:d.w,height:d.h}};this.getCurrentPageDimensionsAtCurrentZoomLevel=function(){return this.getPageDimensionsAtZoomLevel(a.currentPageIndex,a.zoomLevel)};this.isReady=function(){return a.loaded};this.getCurrentPageIndex=function(){return a.currentPageIndex};this.getCurrentPageFilename=function(){return a.pages[a.currentPageIndex].f};this.getCurrentPageNumber=function(){return a.currentPageIndex+1};this.getZoomLevel=function(){return a.zoomLevel};this.getMaxZoomLevel=
function(){return a.maxZoomLevel};this.getMaxZoomLevelForPage=function(b){return W?a.pages[b].m:!1};this.getMinZoomLevel=function(){return a.minZoomLevel};this.setZoomLevel=function(b){a.inGrid&&P();return M(b)};this.zoomIn=function(){return this.setZoomLevel(a.zoomLevel+1)};this.zoomOut=function(){return this.setZoomLevel(a.zoomLevel-1)};this.inViewport=function(b,c,d){b=a.heightAbovePages[b-1]+c;return l(b,b+d)};this.isPageInViewport=function(a){return n(a)};this.toggleFullscreenMode=function(){S()};
this.enterFullscreenMode=function(){return a.inFullscreen?!1:(S(),!0)};this.leaveFullscreenMode=function(){return a.inFullscreen?(S(),!0):!1};this.toggleGridView=function(){P()};this.enterGridView=function(){return a.inGrid?!1:(P(),!0)};this.leaveGridView=function(){return a.inGrid?(P(),!0):!1};this.gotoPageByName=function(a){a=h(a);return f(a)?(y(a,0,0),!0):!1};this.getPageIndex=function(a){return h(a)};this.getCurrentURL=function(){return E()};this.getURLHash=function(){return D()};this.getState=
function(){return C()};this.getInstanceSelector=function(){return a.selector};this.getInstanceId=function(){return a.ID};this.getSettings=function(){return a};this.translateFromMaxZoomLevel=function(b){return b/Math.pow(2,a.maxZoomLevel-a.zoomLevel)};this.translateToMaxZoomLevel=function(b){var c=a.maxZoomLevel-a.zoomLevel;return 0===c?b:b*Math.pow(2,c)};this.setState=function(b){var c;c=h(b.i);f(c)?a.goDirectlyTo=c:f(b.p)&&(a.goDirectlyTo=b.p);a.horizontalOffset=parseInt(b.x,10);a.verticalOffset=
parseInt(b.y,10);b.z>=a.minZoomLevel&&b.z<=a.maxZoomLevel&&(a.zoomLevel=b.z);b.n>=a.minPagesPerRow&&b.n<=a.maxPagesPerRow&&(a.pagesPerRow=b.n);a.inFullscreen!==b.f?(a.inFullscreen=b.f,V(a.inGrid!==b.g)):a.inGrid!==b.g?(a.inGrid=b.g,O()):z()};this.enableScrollable=function(){a.isScrollable||(aa(),a.enableKeyScroll=a.initialKeyScroll,a.enableSpaceScroll=a.initialSpaceScroll,b(a.outerSelector).css("overflow","auto"),a.isScrollable=!0)};this.disableScrollable=function(){a.isScrollable&&(b(a.innerSelector+
".diva-dragger").unbind("mousedown"),b(a.outerSelector).unbind("dblclick"),b(a.outerSelector).unbind("contextmenu"),b(a.outerSelector).css("overflow","hidden"),a.initialKeyScroll=a.enableKeyScroll,a.initialSpaceScroll=a.enableSpaceScroll,a.enableKeyScroll=!1,a.enableSpaceScroll=!1,a.isScrollable=!1)};this.destroy=function(){b("body").removeClass("diva-hide-scrollbar");b(a.parentSelector).empty().removeData("diva");b.each(a.plugins,function(a,b){k(b.destroy)});b(a.parentSelector).removeAttr("style").removeAttr("class")}};
b.fn.diva=function(c){return this.each(function(){var d=b(this);if(!d.data("diva")){c.parentSelector=d;var a=new e(this,c);d.data("diva",a)}})}})(jQuery);(function(b){window.divaPlugins.push(function(){var e={},c={},d={},a,g,k,m={brightnessMax:150,brightnessMin:-100,brightnessStep:1,contrastMax:3,contrastMin:-1,contrastStep:.05,localStoragePrefix:"canvas-",mobileWebkitMaxZoom:2,onInit:null,rgbMax:50,rgbMin:-50,throbberFadeSpeed:200,throbberTimeout:100,buttons:["contrast","brightness","rotation","zoom"]},h=function(b,c){var d=b.context,e=b.size/2,g=-(b.width/2),f=-(b.height/2);d.clearRect(0,0,b.size,b.size);d.save();d.translate(e,e);d.rotate(c*Math.PI/
180);d.drawImage(a,g,f,b.width,b.height);d.restore();b.data=d.getImageData(0,0,b.size,b.size)},l=function(){for(var a in g)if(g[a].current!==g[a].previous)return!0;return!1},f=function(){h(c,g.rotation.current);s(c)},n=function(){var a=g.rotation.current,c=g.zoom.current,f=g.zoom.previous;if(a!==g.rotation.previous||c!==f){var k=b("#diva-canvas-wrapper").scrollLeft(),m=b("#diva-canvas-wrapper").scrollTop(),n=d.viewport.width/2,p=d.viewport.height/2,k=k+n-e.centerX,q=-(m+p-e.centerY),J=(g.rotation.previous-
a)*Math.PI/180,m=Math.cos(J)*k-Math.sin(J)*q+e.centerX,k=-(Math.sin(J)*k+Math.cos(J)*q)+e.centerY,c=Math.pow(2,c-f),n=c*m-n,p=c*k-p;h(e,a);b("#diva-canvas-wrapper").scrollLeft(n);b("#diva-canvas-wrapper").scrollTop(p)}if(l()){s(e);for(var K in g)g[K].previous=g[K].current}},q=function(a){var b=g[a].current!==g[a].initial;return g[a].current!==g[a].previous||b},s=function(a){var b=a.data,c=a.context.createImageData(b),e=c.data,f,h;f=0;for(h=e.length;f<h;f++)e[f]=b.data[f];b=c.data;f=g.contrast.current;
e=(1+Math.min(d.brightnessMax,Math.max(d.brightnessMin,g.brightness.current))/d.brightnessMax)*f;f=128-128*f;h=g.red.current;var k=g.green.current,l=g.blue.current,m=q("red"),n=q("green"),p=q("blue"),t=q("brightness"),r=q("contrast"),t=t||r,u,s,w,B,C,D,E,r=0;for(s=c.width;r<s;r++)for(u=0,w=c.height;u<w;u++)B=4*(u*s+r),C=b[B],D=b[B+1],E=b[B+2],0<C+D+E&&(m&&C&&(C+=h),n&&D&&(D+=k),p&&E&&(E+=l),t&&(C&&(C=C*e+f),D&&(D=D*e+f),E&&(E=E*e+f)),b[B]=C,b[B+1]=D,b[B+2]=E);a.context.clearRect(0,0,s,w);a.context.putImageData(c,
0,0)},r=function(){var a=b("#diva-canvas-wrapper").scrollLeft()*c.scaleFactor,e=b("#diva-canvas-wrapper").scrollTop()*c.scaleFactor,g=Math.min(Math.round(d.viewport.height*c.scaleFactor),d.mapSize)-4,f=Math.min(Math.round(d.viewport.width*c.scaleFactor),d.mapSize)-4;b("#diva-map-viewbox").height(g).width(f).css({top:e,left:a})},L=function(g,h){a=new Image;a.src=g;a.crossOrigin="Anonymous";a.onload=function(){e.size=Math.sqrt(a.width*a.width+a.height*a.height);e.canvas=document.getElementById("diva-canvas");
e.canvas.width=e.size;e.canvas.height=e.size;e.cornerX=(e.size-a.width)/2;e.cornerY=(e.size-a.height)/2;e.width=a.width;e.height=a.height;e.centerX=e.size/2;e.centerY=e.size/2;e.context=e.canvas.getContext("2d");e.context.drawImage(a,e.cornerX,e.cornerY,e.width,e.height);try{e.data=e.context.getImageData(0,0,e.size,e.size)}catch(g){var k='<div id="diva-error" class="diva-error"><p><strong>Error</strong></p><p>'+g.message+"</p>";if("SecurityError"!==g.name)throw g;k+='<p>You may need to update your server configuration in order to use the image manipulation tools. For help, see the <a href="https://github.com/DDMAL/diva.js/wiki/The-API-and-Plugins#a-note-about-canvas-and-cross-site-data" target="_blank">canvas cross-site data documentation</a>.</p></div></div>';
b("#diva-canvas-backdrop").append(k)}void 0===h&&(k=a,c.canvas=document.getElementById("diva-canvas-minimap"),c.size=d.mapSize,c.canvas.width=c.size,c.canvas.height=c.size,c.context=c.canvas.getContext("2d"),c.context.fillRect(0,0,c.size,c.size),c.scaleFactor=d.mapSize/e.size,c.cornerX=e.cornerX*c.scaleFactor,c.cornerY=e.cornerY*c.scaleFactor,c.width=k.width*c.scaleFactor,c.height=k.height*c.scaleFactor,c.context.drawImage(k,c.cornerX,c.cornerY,c.width,c.height),c.data=c.context.getImageData(0,0,
d.mapSize,d.mapSize),b("#diva-map-viewbox").show(),r());f();n(e);F();"function"===typeof h&&h.call(h)}},t=function(){var a=g[k],c=a.current,a=a.transform?a.transform(c):c;b("#diva-canvas-value").html(a)},p=function(){b("#diva-canvas-slider").slider({value:g[k].current})},w=function(a){a=d.zoomWidthRatio*Math.pow(2,a);return d.proxyURL?d.proxyURL+"?f="+d.filename+"&w="+a:d.iipServerURL+"?FIF="+(d.imageDir+"/")+d.filename+"&WID="+a+"&CVT=JPEG"},u=function(){(2<g.zoom.current||d.mobileWebkit)&&b(d.selector+
"throbber").addClass("canvas-throbber").show()},F=function(){b(d.selector+"throbber").removeClass("canvas-throbber").hide()},G=function(){var a={},b=!1,c=d.localStoragePrefix+d.filename,e;for(e in g)g[e].previous!==g[e].initial&&(a[e]=g[e].previous,b=!0);b?(d.pluginIcon.addClass("new"),localStorage.setObject(c,a)):(d.pluginIcon.removeClass("new"),localStorage.removeItem(c))},H=function(a,b){d.zoomLevel=a;var g=w(a);L(g,function(){c.scaleFactor=c.size/e.size;r();G()})};return{init:function(a,h){if(!window.HTMLCanvasElement)return!1;
b.extend(d,m,a.canvasPlugin);d.inCanvas=!1;d.iipServerURL=a.iipServerURL;d.imageDir=a.imageDir;d.selector=a.selector;d.mobileWebkit=a.mobileWebkit;g={contrast:{initial:1,min:d.contrastMin,max:d.contrastMax,step:d.contrastStep,transform:function(a){return a.toFixed(2)},title:"Change the contrast"},brightness:{initial:0,min:d.brightnessMin,max:d.brightnessMax,step:d.brightnessStep,title:"Adjust the brightness"},rotation:{initial:0,min:0,max:359,step:1,transform:function(a){return a+"&deg;"},title:"Rotate the image"},
zoom:{initial:0,min:0,max:0,step:1,title:"Adjust the zoom level"},red:{initial:0,min:d.rgbMin,max:d.rgbMax,step:1,title:"Adjust the red channel"},green:{initial:0,min:d.rgbMin,max:d.rgbMax,step:1,title:"Adjust the green channel"},blue:{initial:0,min:d.rgbMin,max:d.rgbMax,step:1,title:"Adjust the blue channel"}};var q=function(){var a,b,c;for(c in g)b=g[c],a=b.initial,b.current=a,b.previous=a};q();if(b("#diva-canvas-backdrop").length)return!0;var x=[],s,A,w;for(w in d.buttons)s=d.buttons[w],A=g[s].title,
s='<div class="'+s+'" title="'+A+'"></div>',x.push(s);x='<div id="diva-canvas-backdrop">'+('<div id="diva-canvas-tools"><div id="diva-canvas-toolbar"><div id="diva-canvas-close" title="Return to the document viewer"></div><div id="diva-canvas-minimise" title="Minimise the toolbar"></div><span id="diva-canvas-info">Test</span></div><div id="diva-canvas-toolwindow"><div id="diva-map-viewbox"></div><canvas id="diva-canvas-minimap"></canvas><div id="diva-canvas-buttons">'+x.join("")+'</div><div id="diva-canvas-pane"><p id="diva-canvas-tooltip"><span id="diva-canvas-mode">contrast</span>: <span id="diva-canvas-value">0</span> <span id="diva-canvas-reset" class="link">(Reset)</span></p><div id="diva-canvas-slider"></div></div><br /><div class="action-buttons"><a href="#" id="diva-canvas-reset-all">Reset all</a><a href="#" id="diva-canvas-apply">Apply</a></div></div></div>')+
'<div id="diva-canvas-wrapper"><canvas id="diva-canvas"></canvas></div></div>';b("body").append(x);d.mapSize=b("#diva-canvas-minimap").width();b("#diva-canvas-buttons div").click(function(){b("#diva-canvas-buttons .clicked").removeClass("clicked");z(b(this).attr("class"))});var z=function(a){k=a;a=g[k];b("#diva-canvas-buttons ."+k).addClass("clicked");b("#diva-canvas-mode").text(k);var c=a.current,d=a.transform?a.transform(c):c;b("#diva-canvas-slider").slider({min:a.min,max:a.max,step:a.step}).slider("value",
c);b("#diva-canvas-value").html(d)};z("contrast");b("#diva-canvas-slider").slider({slide:function(a,b){g[k].current=b.value;t();f()}});b("#diva-canvas-reset-all").click(function(){for(var a in g)g[a].current=g[a].initial;t();p();f()});b("#diva-canvas-reset").click(function(){g[k].current=g[k].initial;t();p();f()});b("#diva-canvas-apply").click(function(){l()&&(u(),setTimeout(function(){g.zoom.current!==g.zoom.previous?H(g.zoom.current):(n(),F(),G())},d.throbberTimeout))});b("#diva-canvas-close").click(function(){b("body").removeClass("overflow-hidden");
e.context.clearRect(0,0,e.size,e.size);c.context.clearRect(0,0,c.size,c.size);b("#diva-canvas-wrapper").scrollTop(0).scrollLeft(0);b("#diva-canvas-backdrop").hide();b("#diva-map-viewbox").hide();q();t();p();b("#diva-canvas-buttons .clicked").removeClass("clicked");z("contrast");diva.Events.publish("CanvasViewDidHide")});b("#diva-canvas-minimise").click(function(){b("#diva-canvas-toolwindow").slideToggle("fast")});b(window).resize(function(){d.viewport={height:window.innerHeight-a.scrollbarWidth,width:window.innerWidth-
a.scrollbarWidth};d.inCanvas&&r()});b("#diva-canvas-wrapper").scroll(function(){d.inCanvas&&r()});b("#diva-canvas-minimap, #diva-map-viewbox").mouseup(function(a){var e=b("#diva-canvas-minimap").offset(),g=(a.pageX-e.left)/c.scaleFactor;a=(a.pageY-e.top)/c.scaleFactor;b("#diva-canvas-wrapper").scrollTop(a-d.viewport.height/2);b("#diva-canvas-wrapper").scrollLeft(g-d.viewport.width/2)});b("#diva-canvas").mousedown(function(){b(this).addClass("grabbing")}).mouseup(function(){b(this).removeClass("grabbing")});
d.mobileWebkit?b("#diva-canvas-wrapper").kinetic():b("#diva-canvas-wrapper").dragscrollable({acceptPropagatedEvent:!0});"function"===typeof d.onInit&&d.onInit.call(this,d);return!0},pluginName:"canvas",titleText:"View the image on a canvas and adjust various settings",setupHook:function(a){d.viewport={height:window.innerHeight-a.scrollbarWidth,width:window.innerWidth-a.scrollbarWidth};d.minZoomLevel=a.minZoomLevel;d.maxZoomLevel=a.maxZoomLevel;d.mobileWebkit&&(d.maxZoomLevel=Math.min(d.maxZoomLevel,
d.mobileWebkitMaxZoom));g.zoom.min=d.minZoomLevel;g.zoom.max=d.maxZoomLevel},handleClick:function(a,c){var e=b(this).parent().parent(),f=b(e).attr("data-filename"),h=b(e).width()-1,l=c.zoomLevel,m;d.zoomWidthRatio=h/Math.pow(2,l);d.pluginIcon=b(this);d.mobileWebkit&&(l=Math.min(d.maxZoomLevel,l));d.filename=f;g.zoom.initial=l;g.zoom.current=l;if(f=localStorage.getObject(d.localStoragePrefix+d.filename))for(m in f)g[m].current=f[m],m===k&&(t(),p()),"zoom"===m&&(l=f[m]);g.zoom.previous=l;b("body").addClass("overflow-hidden");
b("#diva-canvas-backdrop").show();d.inCanvas=!0;l=w(l);b("#diva-canvas-info").text(b(e).attr("title"));u();diva.Events.publish("CanvasViewDidActivate",[e]);L(l)},onPageLoad:function(a,c,e){null!==localStorage.getItem(d.localStoragePrefix+c)&&b(e).find(".diva-canvas-icon").addClass("new")},destroy:function(){b("#diva-canvas-backdrop").remove()}}}())})(jQuery);(function(b){window.divaPlugins.push(function(){var e,c;return{init:function(b,a){e=b.iipServerURL;c=b.imageDir;return!0},pluginName:"download",titleText:"Download image at the given zoom level",handleClick:function(d){var a=b(this).parent().parent();d=b(a).attr("data-filename");a=b(a).width()-1;window.open(e+"?FIF="+(c+"/")+d+"&WID="+a+"&CVT=JPEG")}}}())})(jQuery);(function(b){window.divaPlugins.push(function(){return{init:function(b,c){function d(a,d,k){var m=b.parentSelector.data("highlights");if("undefined"!==typeof m){if(m.hasOwnProperty(a)){d=c.getInstanceId()+"page-"+a;d=document.getElementById(d);k=m[a].regions;var h=m[a].colour;a=m[a].divClass;for(var m=c.getMaxZoomLevel()-c.getZoomLevel(),l=k.length;l--;){var f=document.createElement("div");f.style.width=k[l].width/Math.pow(2,m)+"px";f.style.height=k[l].height/Math.pow(2,m)+"px";f.style.top=k[l].uly/
Math.pow(2,m)+"px";f.style.left=k[l].ulx/Math.pow(2,m)+"px";f.style.background=h;f.style.border="1px solid #555";f.style.position="absolute";f.style.zIndex=100;f.className=a;"undefined"!==typeof k[l].divID&&(f.id=k[l].divID);d.appendChild(f)}}diva.Events.publish("HighlightCompleted")}}b.parentSelector.data("highlights",{});diva.Events.subscribe("PageWillLoad",d);c.resetHighlights=function(){for(var a=document.getElementById(b.ID+"inner").getElementsByClassName(b.ID+"highlight"),c=a.length;c--;)a[c].parentNode.removeChild(a[c]);
b.parentSelector.data("highlights",{})};c.removeHighlightsOnPage=function(a){var d=b.parentSelector.data("highlights");if(d.hasOwnProperty(a)){for(var k=c.getInstanceId()+"page-"+a,k=document.getElementById(k),m=k.getElementsByTagName("div"),h=d[a].divClass,l=m.length;l--;)m[l].className===h&&k.removeChild(m[l]);delete d[a]}};c.highlightOnPages=function(a,b,d,e){for(var h=a.length;h--;)c.highlightOnPage(a[h],b,d,e)};c.highlightOnPage=function(a,g,k,m){"undefined"===typeof k&&(k="rgba(255, 0, 0, 0.2)");
m="undefined"===typeof m?b.ID+"highlight":b.ID+"highlight "+m;c.getMaxZoomLevel();b.parentSelector.data("highlights")[a]={regions:g,colour:k,divClass:m};for(a=b.numPages;a--;)c.isPageInViewport(a)&&d(a,null,null);return!0};return!0},pluginName:"highlight",titleText:"Highlight regions of pages"}}())})(jQuery);(function(b){window.divaPlugins.push(function(){return{init:function(b,c){return!0},pluginName:"text",titleText:"View the text of this page"}}())})(jQuery);
